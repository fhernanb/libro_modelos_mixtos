<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>28 Single case experimental desing (sced) | Modelos Mixtos con R</title>
  <meta name="description" content="Este libro es para los estudiantes interesados en usar Modelos Mixtos." />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="28 Single case experimental desing (sced) | Modelos Mixtos con R" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/images/cover.png" />
  <meta property="og:description" content="Este libro es para los estudiantes interesados en usar Modelos Mixtos." />
  <meta name="github-repo" content="fhernanb/libro_mod_pred" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="28 Single case experimental desing (sced) | Modelos Mixtos con R" />
  
  <meta name="twitter:description" content="Este libro es para los estudiantes interesados en usar Modelos Mixtos." />
  <meta name="twitter:image" content="/images/cover.png" />

<meta name="author" content="Freddy Hernández Barajas" />
<meta name="author" content="Jorge Leonardo López Martínez" />


<meta name="date" content="2023-11-18" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="simul-glmm.html"/>
<link rel="next" href="blobs.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Modelos Mixtos con R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Bienvenido</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#estructura-del-libro"><i class="fa fa-check"></i>Estructura del libro</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-y-convenciones"><i class="fa fa-check"></i>Software y convenciones</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#bloques-informativos"><i class="fa fa-check"></i>Bloques informativos</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introducción</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#la-complejidad-estructural-tenida-en-cuenta-por-los-modelos-mixtos"><i class="fa fa-check"></i><b>1.1</b> La complejidad estructural tenida en cuenta por los modelos mixtos</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="reg-lin.html"><a href="reg-lin.html"><i class="fa fa-check"></i><b>2</b> Regresión lineal</a>
<ul>
<li class="chapter" data-level="2.1" data-path="reg-lin.html"><a href="reg-lin.html#modelo-estadístico"><i class="fa fa-check"></i><b>2.1</b> Modelo estadístico</a></li>
<li class="chapter" data-level="2.2" data-path="reg-lin.html"><a href="reg-lin.html#verosimilitud-del-modelo"><i class="fa fa-check"></i><b>2.2</b> Verosimilitud del modelo</a>
<ul>
<li class="chapter" data-level="" data-path="reg-lin.html"><a href="reg-lin.html#ejemplo"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="lmm.html"><a href="lmm.html"><i class="fa fa-check"></i><b>3</b> Modelos Lineales Mixtos</a>
<ul>
<li class="chapter" data-level="3.1" data-path="lmm.html"><a href="lmm.html#entrevista-con-jim-ware-y-nan-laird"><i class="fa fa-check"></i><b>3.1</b> Entrevista con Jim Ware y Nan Laird</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="shiny.html"><a href="shiny.html"><i class="fa fa-check"></i><b>4</b> Aplicaciones shiny</a></li>
<li class="chapter" data-level="5" data-path="pac-lme4.html"><a href="pac-lme4.html"><i class="fa fa-check"></i><b>5</b> Paquete <strong>lme4</strong></a>
<ul>
<li class="chapter" data-level="5.1" data-path="pac-lme4.html"><a href="pac-lme4.html#función-lmer"><i class="fa fa-check"></i><b>5.1</b> Función <code>lmer</code></a></li>
<li class="chapter" data-level="" data-path="pac-lme4.html"><a href="pac-lme4.html#ejemplo-modelo-normal-con-intercepto-aleatorio"><i class="fa fa-check"></i>Ejemplo: modelo normal con intercepto aleatorio</a></li>
<li class="chapter" data-level="" data-path="pac-lme4.html"><a href="pac-lme4.html#ejemplo-recuperando-los-interceptos-aleatorios"><i class="fa fa-check"></i>Ejemplo: recuperando los interceptos aleatorios</a></li>
<li class="chapter" data-level="5.2" data-path="pac-lme4.html"><a href="pac-lme4.html#función-glmer"><i class="fa fa-check"></i><b>5.2</b> Función <code>glmer</code></a></li>
<li class="chapter" data-level="" data-path="pac-lme4.html"><a href="pac-lme4.html#ejemplo-modelo-gamma-con-intercepto-aleatorio"><i class="fa fa-check"></i>Ejemplo: modelo gamma con intercepto aleatorio</a></li>
<li class="chapter" data-level="" data-path="pac-lme4.html"><a href="pac-lme4.html#ejemplo-modelo-inversa-gaussiana-con-intercepto-y-pendiente-aleatoria"><i class="fa fa-check"></i>Ejemplo: modelo inversa gaussiana con intercepto y pendiente aleatoria</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="apli-lme4.html"><a href="apli-lme4.html"><i class="fa fa-check"></i><b>6</b> Aplicación con <code>lme4</code></a>
<ul>
<li class="chapter" data-level="" data-path="apli-lme4.html"><a href="apli-lme4.html#ejercicios"><i class="fa fa-check"></i>Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="pac-nlme.html"><a href="pac-nlme.html"><i class="fa fa-check"></i><b>7</b> Paquete <strong>nlme</strong></a>
<ul>
<li class="chapter" data-level="7.1" data-path="pac-nlme.html"><a href="pac-nlme.html#función-lme"><i class="fa fa-check"></i><b>7.1</b> Función <code>lme</code></a></li>
<li class="chapter" data-level="" data-path="pac-nlme.html"><a href="pac-nlme.html#ejemplo-modelo-normal-con-intercepto-aleatorio-1"><i class="fa fa-check"></i>Ejemplo: modelo normal con intercepto aleatorio</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="apli-nlme.html"><a href="apli-nlme.html"><i class="fa fa-check"></i><b>8</b> Aplicación con <code>nlme</code></a>
<ul>
<li class="chapter" data-level="" data-path="apli-nlme.html"><a href="apli-nlme.html#ejercicios-1"><i class="fa fa-check"></i>Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="apli-rat-pup.html"><a href="apli-rat-pup.html"><i class="fa fa-check"></i><b>9</b> Aplicación rat pup</a></li>
<li class="chapter" data-level="10" data-path="estim.html"><a href="estim.html"><i class="fa fa-check"></i><b>10</b> Métodos de estimación</a>
<ul>
<li class="chapter" data-level="10.1" data-path="estim.html"><a href="estim.html#ml-y-reml"><i class="fa fa-check"></i><b>10.1</b> ML y REML</a></li>
<li class="chapter" data-level="" data-path="estim.html"><a href="estim.html#ejemplo-comparando-reml-y-ml-usando-lme4"><i class="fa fa-check"></i>Ejemplo: comparando REML y ML usando <strong>lme4</strong></a></li>
<li class="chapter" data-level="" data-path="estim.html"><a href="estim.html#ejemplo-comparando-reml-y-ml-usando-nlme"><i class="fa fa-check"></i>Ejemplo: comparando REML y ML usando <strong>nlme</strong></a></li>
<li class="chapter" data-level="" data-path="estim.html"><a href="estim.html#ejercicios-2"><i class="fa fa-check"></i>Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ph.html"><a href="ph.html"><i class="fa fa-check"></i><b>11</b> Pruebas de hipótesis</a>
<ul>
<li class="chapter" data-level="11.1" data-path="ph.html"><a href="ph.html#prueba-razón-de-verosimilitud"><i class="fa fa-check"></i><b>11.1</b> Prueba razón de verosimilitud</a></li>
<li class="chapter" data-level="11.2" data-path="ph.html"><a href="ph.html#prueba-de-wald"><i class="fa fa-check"></i><b>11.2</b> Prueba de Wald</a></li>
<li class="chapter" data-level="11.3" data-path="ph.html"><a href="ph.html#prueba-de-hipótesis-sobre-los-efectos-fijos"><i class="fa fa-check"></i><b>11.3</b> Prueba de hipótesis sobre los efectos fijos</a>
<ul>
<li class="chapter" data-level="" data-path="ph.html"><a href="ph.html#ejemplo-1"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="ph.html"><a href="ph.html#ejemplo-2"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="ph.html"><a href="ph.html#prueba-de-hipótesis-sobre-componentes-de-varianza"><i class="fa fa-check"></i><b>11.4</b> Prueba de hipótesis sobre componentes de varianza</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="ph.html"><a href="ph.html#componentes-de-varianza-lejos-del-borde"><i class="fa fa-check"></i><b>11.4.1</b> Componentes de varianza lejos del borde</a></li>
<li class="chapter" data-level="11.4.2" data-path="ph.html"><a href="ph.html#componentes-de-varianza-en-el-borde"><i class="fa fa-check"></i><b>11.4.2</b> Componentes de varianza en el borde</a></li>
<li class="chapter" data-level="" data-path="ph.html"><a href="ph.html#ejemplo-3"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="ph.html"><a href="ph.html#ejemplo-4"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ph.html"><a href="ph.html#ejercicios-3"><i class="fa fa-check"></i>Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="var-fun.html"><a href="var-fun.html"><i class="fa fa-check"></i><b>12</b> Modelando la heterocedasticidad</a>
<ul>
<li class="chapter" data-level="12.1" data-path="var-fun.html"><a href="var-fun.html#opciones-para-modelar-la-varianza"><i class="fa fa-check"></i><b>12.1</b> Opciones para modelar la varianza</a></li>
<li class="chapter" data-level="12.2" data-path="var-fun.html"><a href="var-fun.html#varfixed"><i class="fa fa-check"></i><b>12.2</b> varFixed</a></li>
<li class="chapter" data-level="" data-path="var-fun.html"><a href="var-fun.html#ejemplo-sigma2_y-dependiendo-de-una-variable-cuantitativa"><i class="fa fa-check"></i>Ejemplo: <span class="math inline">\(\sigma^2_y\)</span> dependiendo de una variable cuantitativa</a></li>
<li class="chapter" data-level="12.3" data-path="var-fun.html"><a href="var-fun.html#varident"><i class="fa fa-check"></i><b>12.3</b> varIdent</a></li>
<li class="chapter" data-level="" data-path="var-fun.html"><a href="var-fun.html#ejemplo-sigma2_y-dependiendo-de-una-variable-cualitativa"><i class="fa fa-check"></i>Ejemplo: <span class="math inline">\(\sigma^2_y\)</span> dependiendo de una variable cualitativa</a></li>
<li class="chapter" data-level="12.4" data-path="var-fun.html"><a href="var-fun.html#varexp"><i class="fa fa-check"></i><b>12.4</b> varExp</a></li>
<li class="chapter" data-level="" data-path="var-fun.html"><a href="var-fun.html#ejemplo-sigma2_y-con-estructura-exponencial"><i class="fa fa-check"></i>Ejemplo: <span class="math inline">\(\sigma^2_y\)</span> con estructura exponencial</a></li>
<li class="chapter" data-level="12.5" data-path="var-fun.html"><a href="var-fun.html#varconstpower"><i class="fa fa-check"></i><b>12.5</b> varConstPower</a></li>
<li class="chapter" data-level="" data-path="var-fun.html"><a href="var-fun.html#ejemplo-sigma_y2-dependiendo-de-una-variable-constante-más-la-potencia-de-una-variable-cuantitativa"><i class="fa fa-check"></i>Ejemplo: <span class="math inline">\(\sigma_y^2\)</span> dependiendo de una variable constante más la potencia de una variable cuantitativa</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="more-levels.html"><a href="more-levels.html"><i class="fa fa-check"></i><b>13</b> Modelos con más de dos niveles</a></li>
<li class="chapter" data-level="14" data-path="marginals-effects.html"><a href="marginals-effects.html"><i class="fa fa-check"></i><b>14</b> Paquete <strong>marginaleffects</strong></a>
<ul>
<li class="chapter" data-level="" data-path="marginals-effects.html"><a href="marginals-effects.html#ejemplo-5"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="predict-new.html"><a href="predict-new.html"><i class="fa fa-check"></i><b>15</b> Predicción</a></li>
<li class="chapter" data-level="16" data-path="glmm.html"><a href="glmm.html"><i class="fa fa-check"></i><b>16</b> Modelos Lineales Generalizados Mixtos</a>
<ul>
<li class="chapter" data-level="16.1" data-path="glmm.html"><a href="glmm.html#videos-de-apoyo"><i class="fa fa-check"></i><b>16.1</b> Videos de apoyo</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="pac-glmmTMB.html"><a href="pac-glmmTMB.html"><i class="fa fa-check"></i><b>17</b> Paquete <strong>glmmTMB</strong></a>
<ul>
<li class="chapter" data-level="17.1" data-path="pac-glmmTMB.html"><a href="pac-glmmTMB.html#función-glmmtmb"><i class="fa fa-check"></i><b>17.1</b> Función <code>glmmTMB</code></a></li>
<li class="chapter" data-level="" data-path="pac-glmmTMB.html"><a href="pac-glmmTMB.html#ejemplo-modelo-normal-con-intercepto-aleatorio-2"><i class="fa fa-check"></i>Ejemplo: modelo normal con intercepto aleatorio</a></li>
<li class="chapter" data-level="" data-path="pac-glmmTMB.html"><a href="pac-glmmTMB.html#ejemplo-recuperando-los-interceptos-aleatorios-1"><i class="fa fa-check"></i>Ejemplo: recuperando los interceptos aleatorios</a></li>
<li class="chapter" data-level="" data-path="pac-glmmTMB.html"><a href="pac-glmmTMB.html#ejemplo-modelo-gamma-con-intercepto-aleatorio-1"><i class="fa fa-check"></i>Ejemplo: modelo gamma con intercepto aleatorio</a></li>
</ul></li>
<li class="chapter" data-level="18" data-path="pac-glmm.html"><a href="pac-glmm.html"><i class="fa fa-check"></i><b>18</b> Paquete <strong>glmm</strong></a>
<ul>
<li class="chapter" data-level="18.1" data-path="pac-glmm.html"><a href="pac-glmm.html#función-glmm"><i class="fa fa-check"></i><b>18.1</b> Función <code>glmm</code></a></li>
<li class="chapter" data-level="" data-path="pac-glmm.html"><a href="pac-glmm.html#ejemplo-modelo-poisson-con-intercepto-aleatorio"><i class="fa fa-check"></i>Ejemplo: modelo Poisson con intercepto aleatorio</a></li>
</ul></li>
<li class="chapter" data-level="19" data-path="pac-MASS.html"><a href="pac-MASS.html"><i class="fa fa-check"></i><b>19</b> Paquete <strong>MASS</strong></a>
<ul>
<li class="chapter" data-level="19.1" data-path="pac-MASS.html"><a href="pac-MASS.html#función-glmmpql"><i class="fa fa-check"></i><b>19.1</b> Función <code>glmmPQL</code></a></li>
<li class="chapter" data-level="" data-path="pac-MASS.html"><a href="pac-MASS.html#ejemplo-modelo-bernoulli-binomial-con-intercepto-aleatorio"><i class="fa fa-check"></i>Ejemplo: modelo Bernoulli (binomial) con intercepto aleatorio</a></li>
<li class="chapter" data-level="19.2" data-path="pac-MASS.html"><a href="pac-MASS.html#what-it-means-for-aic-na-in-glmmpql-mass-summary-output"><i class="fa fa-check"></i><b>19.2</b> What it means for AIC NA in glmmPQL (MASS) summary output?</a></li>
<li class="chapter" data-level="19.3" data-path="pac-MASS.html"><a href="pac-MASS.html#two-questions-on-the-results-from-glmmpqlmass"><i class="fa fa-check"></i><b>19.3</b> Two questions on the results from glmmPQL(MASS)</a></li>
<li class="chapter" data-level="19.4" data-path="pac-MASS.html"><a href="pac-MASS.html#how-do-i-interpret-the-variance-of-random-effect-in-a-generalized-linear-mixed-model"><i class="fa fa-check"></i><b>19.4</b> How do I interpret the variance of random effect in a generalized linear mixed model?</a></li>
</ul></li>
<li class="chapter" data-level="20" data-path="paquete-inla.html"><a href="paquete-inla.html"><i class="fa fa-check"></i><b>20</b> Paquete <strong>INLA</strong></a>
<ul>
<li class="chapter" data-level="" data-path="paquete-inla.html"><a href="paquete-inla.html#ejemplo-modelo-poisson-con-intercepto-aleatorio-1"><i class="fa fa-check"></i>Ejemplo: modelo Poisson con intercepto aleatorio</a></li>
<li class="chapter" data-level="" data-path="paquete-inla.html"><a href="paquete-inla.html#ejemplo-modelo-poisson-con-intercepto-y-pendiente-aleatoria"><i class="fa fa-check"></i>Ejemplo: modelo Poisson con intercepto y pendiente aleatoria</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="paquete-gamlss.html"><a href="paquete-gamlss.html"><i class="fa fa-check"></i><b>21</b> Paquete <strong>gamlss</strong></a>
<ul>
<li class="chapter" data-level="21.1" data-path="paquete-gamlss.html"><a href="paquete-gamlss.html#modelo-lineal-mixto-con-intercepto-aleatorio"><i class="fa fa-check"></i><b>21.1</b> Modelo lineal mixto con intercepto aleatorio</a>
<ul>
<li class="chapter" data-level="" data-path="paquete-gamlss.html"><a href="paquete-gamlss.html#ejemplo-6"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="21.2" data-path="paquete-gamlss.html"><a href="paquete-gamlss.html#modelo-lineal-mixto-con-pendiente-aleatoria"><i class="fa fa-check"></i><b>21.2</b> Modelo lineal mixto con pendiente aleatoria</a>
<ul>
<li class="chapter" data-level="" data-path="paquete-gamlss.html"><a href="paquete-gamlss.html#ejemplo-7"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="21.3" data-path="paquete-gamlss.html"><a href="paquete-gamlss.html#modelo-lineal-mixto-con-intercepto-y-pendiente-aleatoria"><i class="fa fa-check"></i><b>21.3</b> Modelo lineal mixto con intercepto y pendiente aleatoria</a>
<ul>
<li class="chapter" data-level="" data-path="paquete-gamlss.html"><a href="paquete-gamlss.html#ejemplo-8"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="22" data-path="glmm_poisson.html"><a href="glmm_poisson.html"><i class="fa fa-check"></i><b>22</b> GLMM Poisson</a></li>
<li class="chapter" data-level="23" data-path="glmm-gamma.html"><a href="glmm-gamma.html"><i class="fa fa-check"></i><b>23</b> GLMM gamma</a></li>
<li class="chapter" data-level="24" data-path="multinomial.html"><a href="multinomial.html"><i class="fa fa-check"></i><b>24</b> Modelo multinomial</a>
<ul>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#ejemplo-modelo-multinomial-nominal"><i class="fa fa-check"></i>Ejemplo: modelo multinomial nominal</a></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#ejemplo-modelo-multinomial-ordinal"><i class="fa fa-check"></i>Ejemplo: modelo multinomial ordinal</a></li>
<li class="chapter" data-level="" data-path="multinomial.html"><a href="multinomial.html#ejemplo-simulando-observaciones-de-un-modelo-multinomial-nominal"><i class="fa fa-check"></i>Ejemplo: simulando observaciones de un modelo multinomial nominal</a></li>
</ul></li>
<li class="chapter" data-level="25" data-path="residuals.html"><a href="residuals.html"><i class="fa fa-check"></i><b>25</b> Diagnósticos con DHARMa</a>
<ul>
<li class="chapter" data-level="" data-path="residuals.html"><a href="residuals.html#ejemplo-modelo-gamma-mixto"><i class="fa fa-check"></i>Ejemplo: modelo gamma mixto</a></li>
</ul></li>
<li class="chapter" data-level="26" data-path="R2.html"><a href="R2.html"><i class="fa fa-check"></i><b>26</b> Coeficiente <span class="math inline">\(R^2\)</span></a>
<ul>
<li class="chapter" data-level="" data-path="R2.html"><a href="R2.html#ejemplo-modelo-normal-con-intercepto-aleatorio-3"><i class="fa fa-check"></i>Ejemplo: modelo normal con intercepto aleatorio</a></li>
<li class="chapter" data-level="" data-path="R2.html"><a href="R2.html#ejemplo-modelo-normal-sin-intercepto-aleatorio"><i class="fa fa-check"></i>Ejemplo: modelo normal sin intercepto aleatorio</a></li>
<li class="chapter" data-level="" data-path="R2.html"><a href="R2.html#ejemplo-modelo-clase-lme"><i class="fa fa-check"></i>Ejemplo: modelo clase lme</a></li>
<li class="chapter" data-level="" data-path="R2.html"><a href="R2.html#ejemplo-modelo-clase-lme4"><i class="fa fa-check"></i>Ejemplo: modelo clase lme4</a></li>
</ul></li>
<li class="chapter" data-level="27" data-path="simul-glmm.html"><a href="simul-glmm.html"><i class="fa fa-check"></i><b>27</b> Simulación de glmm</a></li>
<li class="chapter" data-level="28" data-path="sced.html"><a href="sced.html"><i class="fa fa-check"></i><b>28</b> Single case experimental desing (sced)</a>
<ul>
<li class="chapter" data-level="" data-path="sced.html"><a href="sced.html#ejemplo-simulación-de-un-sced-abab"><i class="fa fa-check"></i>Ejemplo: simulación de un sced ABAB</a></li>
</ul></li>
<li class="chapter" data-level="29" data-path="blobs.html"><a href="blobs.html"><i class="fa fa-check"></i><b>29</b> Otro material interesante</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modelos Mixtos con R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sced" class="section level1 hasAnchor" number="28">
<h1><span class="header-section-number">28</span> Single case experimental desing (sced)<a href="sced.html#sced" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Single-case experimental designs are a family of experimental designs that are characterized by researcher manipulation of an independent variable and repeated measurement of a dependent variable before (i.e., baseline) and after (i.e., intervention phase) introducing the independent variable. In single-case experimental designs a case is the unit of intervention and analysis (e.g., a child, a school). Because measurement within each case is conducted before and after manipulation of the independent variable, the case typically serves as its own control. Experimental variants of single-case designs provide a basis for determining a causal relation by replication of the intervention through (a) introducing and withdrawing the independent variable, (b) manipulating the independent variable across different phases, and (c) introducing the independent variable in a staggered fashion across different points in time. Due to their economy of resources, single-case designs may be useful during development activities and allow for rapid replication across studies. Taken from <a href="10.1093/OBO/9780199828340-0265">this document</a>.</p>
<p>Below we present some types of sced.</p>
<p><img src="images/sced_types.png" width="220%" style="display: block; margin: auto;" /></p>
<div id="ejemplo-simulación-de-un-sced-abab" class="section level2 unnumbered hasAnchor">
<h2>Ejemplo: simulación de un sced ABAB<a href="sced.html#ejemplo-simulación-de-un-sced-abab" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Crear una función para simular datos de un sced ABAB que tenga la estructura mostrada abajo y luego estime los parámetros del modelo.</p>
<p><span class="math display">\[\begin{align*}
y_{ij} | b_0 &amp;\sim  N(\mu_{ij}, \sigma^2_y) \\
\mu_{ij} &amp;= \beta_0 + \beta_1 session_{ij} + \beta_2 expB_{ij} + \beta_3 phase2_{ij} + \beta_4 \, expB_{ij} \, phase2_{ij} + b_{0i} \\
\sigma^2_y &amp;= 1 \\
b_{0} &amp;\sim N(0, \sigma^2_{b0}=1)
\end{align*}\]</span></p>
<p>Para que el experimento tenga un efecto significativo vamos a usar un valor grande <span class="math inline">\(\beta_2=10\)</span>, los valores de los otros coeficientes deben ser los siguientes: <span class="math inline">\(\beta_0=2\)</span>, <span class="math inline">\(\beta_1=0\)</span>, <span class="math inline">\(\beta_3=0\)</span> y <span class="math inline">\(\beta_4=0\)</span>. Estos últimos tres valores en cero significan que las variables experimento, phase y la interacción (experimento y phase) <strong>NO</strong> serán significativas.</p>
<p>Simule datos para 9 sujetos cada uno con 10 observaciones en cada una de las cuatro fases ABAB.</p>
<div style="-moz-box-shadow: 1px 1px 3px 2px #000000;
  -webkit-box-shadow: 1px 1px 3px 2px #000000;
  box-shadow:         1px 1px 3px 2px #000000;">

<div class="rmdexercise">
Solución.
</div>
</div>
<p>Para simular datos del modelo ABAB con la estructura exigida podemos usar esta función.</p>
<div class="sourceCode" id="cb354"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb354-1"><a href="sced.html#cb354-1" tabindex="-1"></a>gen_dat <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n_subject=</span><span class="dv">9</span>, <span class="at">ni=</span><span class="dv">10</span>,</span>
<span id="cb354-2"><a href="sced.html#cb354-2" tabindex="-1"></a>                    <span class="at">beta0=</span><span class="dv">1</span>, <span class="at">beta1=</span><span class="dv">3</span>, <span class="at">beta2=</span><span class="sc">-</span><span class="dv">3</span>, </span>
<span id="cb354-3"><a href="sced.html#cb354-3" tabindex="-1"></a>                    <span class="at">beta3=</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">beta4=</span><span class="dv">4</span>,</span>
<span id="cb354-4"><a href="sced.html#cb354-4" tabindex="-1"></a>                    <span class="at">sd_y=</span><span class="dv">1</span>, <span class="at">sd_b0=</span><span class="dv">1</span>) {</span>
<span id="cb354-5"><a href="sced.html#cb354-5" tabindex="-1"></a>  nobs <span class="ot">&lt;-</span> n_subject <span class="sc">*</span> ni <span class="sc">*</span> <span class="dv">4</span></span>
<span id="cb354-6"><a href="sced.html#cb354-6" tabindex="-1"></a>  subject <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span>n_subject, <span class="at">each=</span>ni <span class="sc">*</span> <span class="dv">4</span>))</span>
<span id="cb354-7"><a href="sced.html#cb354-7" tabindex="-1"></a>  session <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span>(ni<span class="sc">*</span><span class="dv">4</span>), <span class="at">times=</span>n_subject)</span>
<span id="cb354-8"><a href="sced.html#cb354-8" tabindex="-1"></a>  experiment <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="at">each=</span>ni, <span class="at">times=</span>n_subject)</span>
<span id="cb354-9"><a href="sced.html#cb354-9" tabindex="-1"></a>  phase <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">each=</span>ni<span class="sc">*</span><span class="dv">2</span>, <span class="at">times=</span>n_subject)</span>
<span id="cb354-10"><a href="sced.html#cb354-10" tabindex="-1"></a>  phase <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(phase)</span>
<span id="cb354-11"><a href="sced.html#cb354-11" tabindex="-1"></a>  b0 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n=</span>n_subject, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span>sd_b0) <span class="co"># Intercepto aleatorio</span></span>
<span id="cb354-12"><a href="sced.html#cb354-12" tabindex="-1"></a>  b0 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="at">x=</span>b0, <span class="at">each=</span>ni <span class="sc">*</span> <span class="dv">4</span>)               <span class="co"># El mismo intercepto aleatorio pero repetido</span></span>
<span id="cb354-13"><a href="sced.html#cb354-13" tabindex="-1"></a>  <span class="co"># Creando variables indicadoras para exp = B y phase = 2</span></span>
<span id="cb354-14"><a href="sced.html#cb354-14" tabindex="-1"></a>  experiment_B <span class="ot">&lt;-</span> experiment <span class="sc">==</span> <span class="st">&quot;B&quot;</span></span>
<span id="cb354-15"><a href="sced.html#cb354-15" tabindex="-1"></a>  phase_2      <span class="ot">&lt;-</span> phase <span class="sc">==</span> <span class="dv">2</span></span>
<span id="cb354-16"><a href="sced.html#cb354-16" tabindex="-1"></a>  media <span class="ot">&lt;-</span> beta0 <span class="sc">+</span> beta1 <span class="sc">*</span> session <span class="sc">+</span> beta2 <span class="sc">*</span> experiment_B <span class="sc">+</span></span>
<span id="cb354-17"><a href="sced.html#cb354-17" tabindex="-1"></a>    beta3 <span class="sc">*</span> phase_2 <span class="sc">+</span> beta4 <span class="sc">*</span> experiment_B <span class="sc">*</span> phase_2 <span class="sc">+</span> b0</span>
<span id="cb354-18"><a href="sced.html#cb354-18" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n=</span>nobs, <span class="at">mean=</span>media, <span class="at">sd=</span>sd_y)</span>
<span id="cb354-19"><a href="sced.html#cb354-19" tabindex="-1"></a>  datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(subject, session, experiment, phase, y)</span>
<span id="cb354-20"><a href="sced.html#cb354-20" tabindex="-1"></a>  <span class="fu">return</span>(datos)</span>
<span id="cb354-21"><a href="sced.html#cb354-21" tabindex="-1"></a>}</span></code></pre></div>
<p>Vamos a simular los datos.</p>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="sced.html#cb355-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb355-2"><a href="sced.html#cb355-2" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">gen_dat</span>(<span class="at">n_subject =</span> <span class="dv">9</span>, <span class="at">ni=</span><span class="dv">10</span>,</span>
<span id="cb355-3"><a href="sced.html#cb355-3" tabindex="-1"></a>                 <span class="at">beta0=</span><span class="dv">2</span>, <span class="at">beta1=</span><span class="dv">0</span>, <span class="at">beta2=</span><span class="dv">10</span>,</span>
<span id="cb355-4"><a href="sced.html#cb355-4" tabindex="-1"></a>                 <span class="at">beta3=</span><span class="dv">0</span>, <span class="at">beta4=</span><span class="dv">0</span>,</span>
<span id="cb355-5"><a href="sced.html#cb355-5" tabindex="-1"></a>                 <span class="at">sd_y=</span><span class="dv">1</span>, <span class="at">sd_b0=</span><span class="dv">1</span>)</span></code></pre></div>
<p>Exploremos los datos simulados.</p>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="sced.html#cb356-1" tabindex="-1"></a><span class="fu">library</span>(rmarkdown)</span>
<span id="cb356-2"><a href="sced.html#cb356-2" tabindex="-1"></a><span class="fu">paged_table</span>(datos)</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["subject"],"name":[1],"type":["fct"],"align":["left"]},{"label":["session"],"name":[2],"type":["int"],"align":["right"]},{"label":["experiment"],"name":[3],"type":["chr"],"align":["left"]},{"label":["phase"],"name":[4],"type":["fct"],"align":["left"]},{"label":["y"],"name":[5],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"1","3":"A","4":"1","5":"2.40756759"},{"1":"1","2":"2","3":"A","4":"1","5":"1.83760342"},{"1":"1","2":"3","3":"A","4":"1","5":"1.71978327"},{"1":"1","2":"4","3":"A","4":"1","5":"2.77800163"},{"1":"1","2":"5","3":"A","4":"1","5":"4.00816557"},{"1":"1","2":"6","3":"A","4":"1","5":"3.88695178"},{"1":"1","2":"7","3":"A","4":"1","5":"2.89133914"},{"1":"1","2":"8","3":"A","4":"1","5":"2.09869028"},{"1":"1","2":"9","3":"A","4":"1","5":"3.76426159"},{"1":"1","2":"10","3":"A","4":"1","5":"4.50194414"},{"1":"1","2":"11","3":"B","4":"1","5":"13.39342106"},{"1":"1","2":"12","3":"B","4":"1","5":"12.07975840"},{"1":"1","2":"13","3":"B","4":"1","5":"14.09028737"},{"1":"1","2":"14","3":"B","4":"1","5":"12.87222572"},{"1":"1","2":"15","3":"B","4":"1","5":"13.02327300"},{"1":"1","2":"16","3":"B","4":"1","5":"13.29632812"},{"1":"1","2":"17","3":"B","4":"1","5":"12.40637012"},{"1":"1","2":"18","3":"B","4":"1","5":"12.85031917"},{"1":"1","2":"19","3":"B","4":"1","5":"13.53861227"},{"1":"1","2":"20","3":"B","4":"1","5":"13.80558249"},{"1":"1","2":"21","3":"A","4":"2","5":"2.21324157"},{"1":"1","2":"22","3":"A","4":"2","5":"1.97786617"},{"1":"1","2":"23","3":"A","4":"2","5":"2.90329150"},{"1":"1","2":"24","3":"A","4":"2","5":"1.78753490"},{"1":"1","2":"25","3":"A","4":"2","5":"0.08486479"},{"1":"1","2":"26","3":"A","4":"2","5":"1.70387356"},{"1":"1","2":"27","3":"A","4":"2","5":"1.97204840"},{"1":"1","2":"28","3":"A","4":"2","5":"4.39380702"},{"1":"1","2":"29","3":"A","4":"2","5":"3.84882154"},{"1":"1","2":"30","3":"A","4":"2","5":"3.87772760"},{"1":"1","2":"31","3":"B","4":"2","5":"11.71782798"},{"1":"1","2":"32","3":"B","4":"2","5":"11.76242867"},{"1":"1","2":"33","3":"B","4":"2","5":"13.80155411"},{"1":"1","2":"34","3":"B","4":"2","5":"13.00476572"},{"1":"1","2":"35","3":"B","4":"2","5":"11.93748288"},{"1":"1","2":"36","3":"B","4":"2","5":"12.99202242"},{"1":"1","2":"37","3":"B","4":"2","5":"12.33178470"},{"1":"1","2":"38","3":"B","4":"2","5":"11.86781055"},{"1":"1","2":"39","3":"B","4":"2","5":"12.71999903"},{"1":"1","2":"40","3":"B","4":"2","5":"13.91968298"},{"1":"2","2":"1","3":"A","4":"1","5":"0.51230397"},{"1":"2","2":"2","3":"A","4":"1","5":"-0.04376984"},{"1":"2","2":"3","3":"A","4":"1","5":"1.23226015"},{"1":"2","2":"4","3":"A","4":"1","5":"2.04541810"},{"1":"2","2":"5","3":"A","4":"1","5":"3.18461304"},{"1":"2","2":"6","3":"A","4":"1","5":"3.26119485"},{"1":"2","2":"7","3":"A","4":"1","5":"1.38438370"},{"1":"2","2":"8","3":"A","4":"1","5":"0.64650348"},{"1":"2","2":"9","3":"A","4":"1","5":"0.23318704"},{"1":"2","2":"10","3":"A","4":"1","5":"1.47120553"},{"1":"2","2":"11","3":"B","4":"1","5":"11.60202972"},{"1":"2","2":"12","3":"B","4":"1","5":"11.07496886"},{"1":"2","2":"13","3":"B","4":"1","5":"12.03702798"},{"1":"2","2":"14","3":"B","4":"1","5":"11.84676279"},{"1":"2","2":"15","3":"B","4":"1","5":"10.88711181"},{"1":"2","2":"16","3":"B","4":"1","5":"12.32437396"},{"1":"2","2":"17","3":"B","4":"1","5":"11.47801756"},{"1":"2","2":"18","3":"B","4":"1","5":"11.53928758"},{"1":"2","2":"19","3":"B","4":"1","5":"11.74710900"},{"1":"2","2":"20","3":"B","4":"1","5":"11.23930064"},{"1":"2","2":"21","3":"A","4":"2","5":"0.98604588"},{"1":"2","2":"22","3":"A","4":"2","5":"3.02645975"},{"1":"2","2":"23","3":"A","4":"2","5":"2.28845167"},{"1":"2","2":"24","3":"A","4":"2","5":"-0.08109212"},{"1":"2","2":"25","3":"A","4":"2","5":"2.16229114"},{"1":"2","2":"26","3":"A","4":"2","5":"0.28286326"},{"1":"2","2":"27","3":"A","4":"2","5":"2.67678138"},{"1":"2","2":"28","3":"A","4":"2","5":"1.00096984"},{"1":"2","2":"29","3":"A","4":"2","5":"1.77271253"},{"1":"2","2":"30","3":"A","4":"2","5":"0.16042005"},{"1":"2","2":"31","3":"B","4":"2","5":"9.42158586"},{"1":"2","2":"32","3":"B","4":"2","5":"12.88191580"},{"1":"2","2":"33","3":"B","4":"2","5":"11.01921679"},{"1":"2","2":"34","3":"B","4":"2","5":"10.15013009"},{"1":"2","2":"35","3":"B","4":"2","5":"12.24230377"},{"1":"2","2":"36","3":"B","4":"2","5":"10.65902165"},{"1":"2","2":"37","3":"B","4":"2","5":"11.77100660"},{"1":"2","2":"38","3":"B","4":"2","5":"12.57199966"},{"1":"2","2":"39","3":"B","4":"2","5":"12.15662999"},{"1":"2","2":"40","3":"B","4":"2","5":"12.24675756"},{"1":"3","2":"1","3":"A","4":"1","5":"1.39111207"},{"1":"3","2":"2","3":"A","4":"1","5":"1.14814624"},{"1":"3","2":"3","3":"A","4":"1","5":"2.90509932"},{"1":"3","2":"4","3":"A","4":"1","5":"2.20997836"},{"1":"3","2":"5","3":"A","4":"1","5":"1.30036046"},{"1":"3","2":"6","3":"A","4":"1","5":"2.36980796"},{"1":"3","2":"7","3":"A","4":"1","5":"2.50909030"},{"1":"3","2":"8","3":"A","4":"1","5":"2.01424479"},{"1":"3","2":"9","3":"A","4":"1","5":"3.22859439"},{"1":"3","2":"10","3":"A","4":"1","5":"1.70536858"},{"1":"3","2":"11","3":"B","4":"1","5":"11.77370909"},{"1":"3","2":"12","3":"B","4":"1","5":"10.79420889"},{"1":"3","2":"13","3":"B","4":"1","5":"12.74354932"},{"1":"3","2":"14","3":"B","4":"1","5":"10.43864314"},{"1":"3","2":"15","3":"B","4":"1","5":"12.22686044"},{"1":"3","2":"16","3":"B","4":"1","5":"12.50868806"},{"1":"3","2":"17","3":"B","4":"1","5":"12.62805017"},{"1":"3","2":"18","3":"B","4":"1","5":"10.37373791"},{"1":"3","2":"19","3":"B","4":"1","5":"11.64393541"},{"1":"3","2":"20","3":"B","4":"1","5":"10.68408800"},{"1":"3","2":"21","3":"A","4":"2","5":"2.90420747"},{"1":"3","2":"22","3":"A","4":"2","5":"0.77839127"},{"1":"3","2":"23","3":"A","4":"2","5":"1.89404235"},{"1":"3","2":"24","3":"A","4":"2","5":"1.55882994"},{"1":"3","2":"25","3":"A","4":"2","5":"1.15211382"},{"1":"3","2":"26","3":"A","4":"2","5":"1.37599925"},{"1":"3","2":"27","3":"A","4":"2","5":"1.24575793"},{"1":"3","2":"28","3":"A","4":"2","5":"0.70070065"},{"1":"3","2":"29","3":"A","4":"2","5":"2.65818649"},{"1":"3","2":"30","3":"A","4":"2","5":"1.23629409"},{"1":"3","2":"31","3":"B","4":"2","5":"11.46391137"},{"1":"3","2":"32","3":"B","4":"2","5":"12.82875402"},{"1":"3","2":"33","3":"B","4":"2","5":"10.03650367"},{"1":"3","2":"34","3":"B","4":"2","5":"9.37255830"},{"1":"3","2":"35","3":"B","4":"2","5":"9.60439025"},{"1":"3","2":"36","3":"B","4":"2","5":"10.99699181"},{"1":"3","2":"37","3":"B","4":"2","5":"12.36272040"},{"1":"3","2":"38","3":"B","4":"2","5":"11.54159815"},{"1":"3","2":"39","3":"B","4":"2","5":"11.97201552"},{"1":"3","2":"40","3":"B","4":"2","5":"10.66740083"},{"1":"4","2":"1","3":"A","4":"1","5":"2.42893041"},{"1":"4","2":"2","3":"A","4":"1","5":"2.13130982"},{"1":"4","2":"3","3":"A","4":"1","5":"1.06590906"},{"1":"4","2":"4","3":"A","4":"1","5":"2.88091514"},{"1":"4","2":"5","3":"A","4":"1","5":"2.58911188"},{"1":"4","2":"6","3":"A","4":"1","5":"0.53301707"},{"1":"4","2":"7","3":"A","4":"1","5":"2.97098526"},{"1":"4","2":"8","3":"A","4":"1","5":"1.87971962"},{"1":"4","2":"9","3":"A","4":"1","5":"3.91886144"},{"1":"4","2":"10","3":"A","4":"1","5":"2.26475181"},{"1":"4","2":"11","3":"B","4":"1","5":"11.28164678"},{"1":"4","2":"12","3":"B","4":"1","5":"14.03541989"},{"1":"4","2":"13","3":"B","4":"1","5":"12.20868448"},{"1":"4","2":"14","3":"B","4":"1","5":"11.73253830"},{"1":"4","2":"15","3":"B","4":"1","5":"13.14035367"},{"1":"4","2":"16","3":"B","4":"1","5":"13.25060139"},{"1":"4","2":"17","3":"B","4":"1","5":"11.28865461"},{"1":"4","2":"18","3":"B","4":"1","5":"12.86294272"},{"1":"4","2":"19","3":"B","4":"1","5":"10.09248007"},{"1":"4","2":"20","3":"B","4":"1","5":"11.73692523"},{"1":"4","2":"21","3":"A","4":"2","5":"2.46835217"},{"1":"4","2":"22","3":"A","4":"2","5":"2.34570120"},{"1":"4","2":"23","3":"A","4":"2","5":"3.05199769"},{"1":"4","2":"24","3":"A","4":"2","5":"1.59620927"},{"1":"4","2":"25","3":"A","4":"2","5":"2.16912618"},{"1":"4","2":"26","3":"A","4":"2","5":"1.92571670"},{"1":"4","2":"27","3":"A","4":"2","5":"3.36030449"},{"1":"4","2":"28","3":"A","4":"2","5":"1.36721815"},{"1":"4","2":"29","3":"A","4":"2","5":"3.62853898"},{"1":"4","2":"30","3":"A","4":"2","5":"2.94114897"},{"1":"4","2":"31","3":"B","4":"2","5":"12.88988691"},{"1":"4","2":"32","3":"B","4":"2","5":"11.74486527"},{"1":"4","2":"33","3":"B","4":"2","5":"12.18788747"},{"1":"4","2":"34","3":"B","4":"2","5":"12.23947566"},{"1":"4","2":"35","3":"B","4":"2","5":"9.63167487"},{"1":"4","2":"36","3":"B","4":"2","5":"11.74545844"},{"1":"4","2":"37","3":"B","4":"2","5":"10.77250581"},{"1":"4","2":"38","3":"B","4":"2","5":"10.17743542"},{"1":"4","2":"39","3":"B","4":"2","5":"12.66700922"},{"1":"4","2":"40","3":"B","4":"2","5":"10.37230969"},{"1":"5","2":"1","3":"A","4":"1","5":"3.85387649"},{"1":"5","2":"2","3":"A","4":"1","5":"2.67350742"},{"1":"5","2":"3","3":"A","4":"1","5":"6.09705898"},{"1":"5","2":"4","3":"A","4":"1","5":"5.22801529"},{"1":"5","2":"5","3":"A","4":"1","5":"3.92205508"},{"1":"5","2":"6","3":"A","4":"1","5":"5.44565668"},{"1":"5","2":"7","3":"A","4":"1","5":"3.91873661"},{"1":"5","2":"8","3":"A","4":"1","5":"4.41862355"},{"1":"5","2":"9","3":"A","4":"1","5":"3.82201203"},{"1":"5","2":"10","3":"A","4":"1","5":"6.21821433"},{"1":"5","2":"11","3":"B","4":"1","5":"14.81162435"},{"1":"5","2":"12","3":"B","4":"1","5":"13.61075040"},{"1":"5","2":"13","3":"B","4":"1","5":"14.20528113"},{"1":"5","2":"14","3":"B","4":"1","5":"15.38639964"},{"1":"5","2":"15","3":"B","4":"1","5":"14.54148702"},{"1":"5","2":"16","3":"B","4":"1","5":"14.71465188"},{"1":"5","2":"17","3":"B","4":"1","5":"15.43412430"},{"1":"5","2":"18","3":"B","4":"1","5":"12.84252815"},{"1":"5","2":"19","3":"B","4":"1","5":"13.62864938"},{"1":"5","2":"20","3":"B","4":"1","5":"13.59516573"},{"1":"5","2":"21","3":"A","4":"2","5":"4.96007950"},{"1":"5","2":"22","3":"A","4":"2","5":"2.62432916"},{"1":"5","2":"23","3":"A","4":"2","5":"3.80413898"},{"1":"5","2":"24","3":"A","4":"2","5":"5.37127012"},{"1":"5","2":"25","3":"A","4":"2","5":"4.43825240"},{"1":"5","2":"26","3":"A","4":"2","5":"3.89019604"},{"1":"5","2":"27","3":"A","4":"2","5":"4.49925773"},{"1":"5","2":"28","3":"A","4":"2","5":"4.61082401"},{"1":"5","2":"29","3":"A","4":"2","5":"4.26918874"},{"1":"5","2":"30","3":"A","4":"2","5":"4.01697857"},{"1":"5","2":"31","3":"B","4":"2","5":"13.86156909"},{"1":"5","2":"32","3":"B","4":"2","5":"13.13170268"},{"1":"5","2":"33","3":"B","4":"2","5":"14.18993182"},{"1":"5","2":"34","3":"B","4":"2","5":"14.96639752"},{"1":"5","2":"35","3":"B","4":"2","5":"15.02530065"},{"1":"5","2":"36","3":"B","4":"2","5":"16.23596132"},{"1":"5","2":"37","3":"B","4":"2","5":"15.13352789"},{"1":"5","2":"38","3":"B","4":"2","5":"13.09969260"},{"1":"5","2":"39","3":"B","4":"2","5":"14.80752316"},{"1":"5","2":"40","3":"B","4":"2","5":"14.52061375"},{"1":"6","2":"1","3":"A","4":"1","5":"4.10239208"},{"1":"6","2":"2","3":"A","4":"1","5":"0.92613867"},{"1":"6","2":"3","3":"A","4":"1","5":"3.31322909"},{"1":"6","2":"4","3":"A","4":"1","5":"2.80598635"},{"1":"6","2":"5","3":"A","4":"1","5":"2.93520556"},{"1":"6","2":"6","3":"A","4":"1","5":"3.69200679"},{"1":"6","2":"7","3":"A","4":"1","5":"2.62312261"},{"1":"6","2":"8","3":"A","4":"1","5":"3.30647767"},{"1":"6","2":"9","3":"A","4":"1","5":"2.38826036"},{"1":"6","2":"10","3":"A","4":"1","5":"3.42718764"},{"1":"6","2":"11","3":"B","4":"1","5":"14.25184699"},{"1":"6","2":"12","3":"B","4":"1","5":"14.31125564"},{"1":"6","2":"13","3":"B","4":"1","5":"12.71007554"},{"1":"6","2":"14","3":"B","4":"1","5":"11.07167248"},{"1":"6","2":"15","3":"B","4":"1","5":"12.83670517"},{"1":"6","2":"16","3":"B","4":"1","5":"12.91872130"},{"1":"6","2":"17","3":"B","4":"1","5":"12.85923481"},{"1":"6","2":"18","3":"B","4":"1","5":"12.18587025"},{"1":"6","2":"19","3":"B","4":"1","5":"11.77445796"},{"1":"6","2":"20","3":"B","4":"1","5":"12.23394537"},{"1":"6","2":"21","3":"A","4":"2","5":"3.89775935"},{"1":"6","2":"22","3":"A","4":"2","5":"4.22450922"},{"1":"6","2":"23","3":"A","4":"2","5":"2.03646207"},{"1":"6","2":"24","3":"A","4":"2","5":"3.72180891"},{"1":"6","2":"25","3":"A","4":"2","5":"2.23739955"},{"1":"6","2":"26","3":"A","4":"2","5":"2.69982175"},{"1":"6","2":"27","3":"A","4":"2","5":"2.51853195"},{"1":"6","2":"28","3":"A","4":"2","5":"2.04512384"},{"1":"6","2":"29","3":"A","4":"2","5":"3.57568668"},{"1":"6","2":"30","3":"A","4":"2","5":"2.22650063"},{"1":"6","2":"31","3":"B","4":"2","5":"12.39266766"},{"1":"6","2":"32","3":"B","4":"2","5":"13.11707204"},{"1":"6","2":"33","3":"B","4":"2","5":"12.66071693"},{"1":"6","2":"34","3":"B","4":"2","5":"13.16968139"},{"1":"6","2":"35","3":"B","4":"2","5":"12.18624975"},{"1":"6","2":"36","3":"B","4":"2","5":"12.80382460"},{"1":"6","2":"37","3":"B","4":"2","5":"13.55955284"},{"1":"6","2":"38","3":"B","4":"2","5":"11.96341033"},{"1":"6","2":"39","3":"B","4":"2","5":"12.40383779"},{"1":"6","2":"40","3":"B","4":"2","5":"12.70665416"},{"1":"7","2":"1","3":"A","4":"1","5":"3.39850428"},{"1":"7","2":"2","3":"A","4":"1","5":"3.59759259"},{"1":"7","2":"3","3":"A","4":"1","5":"2.74551908"},{"1":"7","2":"4","3":"A","4":"1","5":"3.44187815"},{"1":"7","2":"5","3":"A","4":"1","5":"3.81269854"},{"1":"7","2":"6","3":"A","4":"1","5":"0.93881300"},{"1":"7","2":"7","3":"A","4":"1","5":"3.83839548"},{"1":"7","2":"8","3":"A","4":"1","5":"3.91785692"},{"1":"7","2":"9","3":"A","4":"1","5":"2.64495297"},{"1":"7","2":"10","3":"A","4":"1","5":"1.94173939"},{"1":"7","2":"11","3":"B","4":"1","5":"13.88817268"},{"1":"7","2":"12","3":"B","4":"1","5":"12.98729351"},{"1":"7","2":"13","3":"B","4":"1","5":"14.25209242"},{"1":"7","2":"14","3":"B","4":"1","5":"14.36042146"},{"1":"7","2":"15","3":"B","4":"1","5":"14.32739780"},{"1":"7","2":"16","3":"B","4":"1","5":"11.67252672"},{"1":"7","2":"17","3":"B","4":"1","5":"15.90014780"},{"1":"7","2":"18","3":"B","4":"1","5":"12.93999534"},{"1":"7","2":"19","3":"B","4":"1","5":"13.21269039"},{"1":"7","2":"20","3":"B","4":"1","5":"12.56628708"},{"1":"7","2":"21","3":"A","4":"2","5":"3.68330225"},{"1":"7","2":"22","3":"A","4":"2","5":"3.33722565"},{"1":"7","2":"23","3":"A","4":"2","5":"3.59919639"},{"1":"7","2":"24","3":"A","4":"2","5":"2.16117877"},{"1":"7","2":"25","3":"A","4":"2","5":"3.56576223"},{"1":"7","2":"26","3":"A","4":"2","5":"3.88882804"},{"1":"7","2":"27","3":"A","4":"2","5":"4.93940514"},{"1":"7","2":"28","3":"A","4":"2","5":"5.18980633"},{"1":"7","2":"29","3":"A","4":"2","5":"3.24973102"},{"1":"7","2":"30","3":"A","4":"2","5":"1.07989998"},{"1":"7","2":"31","3":"B","4":"2","5":"13.88720692"},{"1":"7","2":"32","3":"B","4":"2","5":"12.95223014"},{"1":"7","2":"33","3":"B","4":"2","5":"14.99675483"},{"1":"7","2":"34","3":"B","4":"2","5":"13.45641055"},{"1":"7","2":"35","3":"B","4":"2","5":"14.34259859"},{"1":"7","2":"36","3":"B","4":"2","5":"14.03396846"},{"1":"7","2":"37","3":"B","4":"2","5":"12.95371965"},{"1":"7","2":"38","3":"B","4":"2","5":"13.62074558"},{"1":"7","2":"39","3":"B","4":"2","5":"14.19294865"},{"1":"7","2":"40","3":"B","4":"2","5":"14.71194407"},{"1":"8","2":"1","3":"A","4":"1","5":"4.16922804"},{"1":"8","2":"2","3":"A","4":"1","5":"3.94006092"},{"1":"8","2":"3","3":"A","4":"1","5":"3.64304663"},{"1":"8","2":"4","3":"A","4":"1","5":"5.52377879"},{"1":"8","2":"5","3":"A","4":"1","5":"5.02900943"},{"1":"8","2":"6","3":"A","4":"1","5":"3.69035683"},{"1":"8","2":"7","3":"A","4":"1","5":"2.43349950"},{"1":"8","2":"8","3":"A","4":"1","5":"4.83082334"},{"1":"8","2":"9","3":"A","4":"1","5":"3.54218074"},{"1":"8","2":"10","3":"A","4":"1","5":"6.87348152"},{"1":"8","2":"11","3":"B","4":"1","5":"16.71217638"},{"1":"8","2":"12","3":"B","4":"1","5":"15.65387711"},{"1":"8","2":"13","3":"B","4":"1","5":"15.17801049"},{"1":"8","2":"14","3":"B","4":"1","5":"15.71681500"},{"1":"8","2":"15","3":"B","4":"1","5":"13.77933421"},{"1":"8","2":"16","3":"B","4":"1","5":"13.50216245"},{"1":"8","2":"17","3":"B","4":"1","5":"14.37905377"},{"1":"8","2":"18","3":"B","4":"1","5":"13.61980692"},{"1":"8","2":"19","3":"B","4":"1","5":"13.97648298"},{"1":"8","2":"20","3":"B","4":"1","5":"15.52198661"},{"1":"8","2":"21","3":"A","4":"2","5":"4.08722273"},{"1":"8","2":"22","3":"A","4":"2","5":"0.73680355"},{"1":"8","2":"23","3":"A","4":"2","5":"3.93364820"},{"1":"8","2":"24","3":"A","4":"2","5":"5.91644561"},{"1":"8","2":"25","3":"A","4":"2","5":"5.21388080"},{"1":"8","2":"26","3":"A","4":"2","5":"3.23311944"},{"1":"8","2":"27","3":"A","4":"2","5":"4.84682356"},{"1":"8","2":"28","3":"A","4":"2","5":"5.22841491"},{"1":"8","2":"29","3":"A","4":"2","5":"6.09443909"},{"1":"8","2":"30","3":"A","4":"2","5":"2.51772630"},{"1":"8","2":"31","3":"B","4":"2","5":"15.67384287"},{"1":"8","2":"32","3":"B","4":"2","5":"14.92678823"},{"1":"8","2":"33","3":"B","4":"2","5":"14.24641110"},{"1":"8","2":"34","3":"B","4":"2","5":"14.60096233"},{"1":"8","2":"35","3":"B","4":"2","5":"13.04925472"},{"1":"8","2":"36","3":"B","4":"2","5":"15.49334387"},{"1":"8","2":"37","3":"B","4":"2","5":"13.23504972"},{"1":"8","2":"38","3":"B","4":"2","5":"16.06433914"},{"1":"8","2":"39","3":"B","4":"2","5":"13.93417887"},{"1":"8","2":"40","3":"B","4":"2","5":"15.96920247"},{"1":"9","2":"1","3":"A","4":"1","5":"4.09424648"},{"1":"9","2":"2","3":"A","4":"1","5":"1.98298539"},{"1":"9","2":"3","3":"A","4":"1","5":"3.78180242"},{"1":"9","2":"4","3":"A","4":"1","5":"1.36479987"},{"1":"9","2":"5","3":"A","4":"1","5":"4.04211414"},{"1":"9","2":"6","3":"A","4":"1","5":"3.08278995"},{"1":"9","2":"7","3":"A","4":"1","5":"2.14879258"},{"1":"9","2":"8","3":"A","4":"1","5":"3.46481253"},{"1":"9","2":"9","3":"A","4":"1","5":"3.33152542"},{"1":"9","2":"10","3":"A","4":"1","5":"4.18588516"},{"1":"9","2":"11","3":"B","4":"1","5":"13.28206935"},{"1":"9","2":"12","3":"B","4":"1","5":"13.64436174"},{"1":"9","2":"13","3":"B","4":"1","5":"13.84059066"},{"1":"9","2":"14","3":"B","4":"1","5":"13.72016538"},{"1":"9","2":"15","3":"B","4":"1","5":"13.31746233"},{"1":"9","2":"16","3":"B","4":"1","5":"13.84857843"},{"1":"9","2":"17","3":"B","4":"1","5":"13.55253728"},{"1":"9","2":"18","3":"B","4":"1","5":"12.20723358"},{"1":"9","2":"19","3":"B","4":"1","5":"12.44267328"},{"1":"9","2":"20","3":"B","4":"1","5":"13.35152228"},{"1":"9","2":"21","3":"A","4":"2","5":"2.13702568"},{"1":"9","2":"22","3":"A","4":"2","5":"3.44967391"},{"1":"9","2":"23","3":"A","4":"2","5":"3.02441137"},{"1":"9","2":"24","3":"A","4":"2","5":"2.86074057"},{"1":"9","2":"25","3":"A","4":"2","5":"2.61061446"},{"1":"9","2":"26","3":"A","4":"2","5":"0.85483218"},{"1":"9","2":"27","3":"A","4":"2","5":"3.79797623"},{"1":"9","2":"28","3":"A","4":"2","5":"4.58306186"},{"1":"9","2":"29","3":"A","4":"2","5":"4.49231255"},{"1":"9","2":"30","3":"A","4":"2","5":"1.61363412"},{"1":"9","2":"31","3":"B","4":"2","5":"13.30121059"},{"1":"9","2":"32","3":"B","4":"2","5":"11.53942660"},{"1":"9","2":"33","3":"B","4":"2","5":"14.25004184"},{"1":"9","2":"34","3":"B","4":"2","5":"11.87371596"},{"1":"9","2":"35","3":"B","4":"2","5":"15.17719973"},{"1":"9","2":"36","3":"B","4":"2","5":"11.42648733"},{"1":"9","2":"37","3":"B","4":"2","5":"13.79618960"},{"1":"9","2":"38","3":"B","4":"2","5":"14.97392462"},{"1":"9","2":"39","3":"B","4":"2","5":"12.46241563"},{"1":"9","2":"40","3":"B","4":"2","5":"13.74221626"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Vamos a dibujar la evoluación de la variable respuesta <span class="math inline">\(Y\)</span> para ver si se refleja el efecto del experimento.</p>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="sced.html#cb357-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb357-2"><a href="sced.html#cb357-2" tabindex="-1"></a></span>
<span id="cb357-3"><a href="sced.html#cb357-3" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(<span class="at">x =</span> session, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb357-4"><a href="sced.html#cb357-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb357-5"><a href="sced.html#cb357-5" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb357-6"><a href="sced.html#cb357-6" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>subject) <span class="sc">+</span> </span>
<span id="cb357-7"><a href="sced.html#cb357-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Session&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Outcome measure&quot;</span>, <span class="at">color =</span> <span class="st">&quot;Phase&quot;</span>) <span class="sc">+</span></span>
<span id="cb357-8"><a href="sced.html#cb357-8" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&quot;Simulated ABAB experiment in a single-case design&quot;</span>)</span></code></pre></div>
<p><img src="libro_mod_mixtos_files/figure-html/sced01-1.png" width="672" /></p>
<p>De la figura anterior se ve claramente que cuando el experimento es B, la variable <span class="math inline">\(Y\)</span> está en un mayor nivel, cuando el experimento es A, los valores de <span class="math inline">\(Y\)</span> disminuyen, esto sucede con todos los sujetos.</p>
<p>Ahora vamos a estimar los parámetros del modelo con lmee para ver si coinciden con los valores usados en la generación de los datos.</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="sced.html#cb358-1" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb358-2"><a href="sced.html#cb358-2" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(y <span class="sc">~</span> session <span class="sc">+</span> experiment <span class="sc">*</span> phase <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>subject), </span>
<span id="cb358-3"><a href="sced.html#cb358-3" tabindex="-1"></a>           <span class="at">data =</span> datos)</span>
<span id="cb358-4"><a href="sced.html#cb358-4" tabindex="-1"></a></span>
<span id="cb358-5"><a href="sced.html#cb358-5" tabindex="-1"></a><span class="fu">summary</span>(mod1)</span></code></pre></div>
<pre><code>## Linear mixed model fit by REML [&#39;lmerMod&#39;]
## Formula: y ~ session + experiment * phase + (1 | subject)
##    Data: datos
## 
## REML criterion at convergence: 1071.2
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -3.6081 -0.6842  0.0281  0.7274  2.2774 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  subject  (Intercept) 1.192    1.092   
##  Residual             1.020    1.010   
## Number of obs: 360, groups:  subject, 9
## 
## Fixed effects:
##                    Estimate Std. Error t value
## (Intercept)         2.92466    0.39265   7.449
## session             0.00929    0.01853   0.501
## experimentB         9.95197    0.23872  41.690
## phase2             -0.30608    0.39996  -0.765
## experimentB:phase2 -0.04177    0.21287  -0.196
## 
## Correlation of Fixed Effects:
##             (Intr) sessin exprmB phase2
## session     -0.260                     
## experimentB  0.081 -0.776              
## phase2       0.168 -0.926  0.838       
## exprmntB:p2  0.136  0.000 -0.446 -0.266</code></pre>
<p>Vamos a repetir el ejercicio pero usando el paquete gamlss.</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="sced.html#cb360-1" tabindex="-1"></a><span class="fu">library</span>(gamlss)</span>
<span id="cb360-2"><a href="sced.html#cb360-2" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">gamlss</span>(y <span class="sc">~</span> session <span class="sc">+</span> experiment <span class="sc">*</span> phase <span class="sc">+</span> <span class="fu">re</span>(<span class="at">random=</span><span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>subject), <span class="at">data=</span>datos)</span></code></pre></div>
<pre><code>## GAMLSS-RS iteration 1: Global Deviance = 1015.582 
## GAMLSS-RS iteration 2: Global Deviance = 1015.582</code></pre>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="sced.html#cb362-1" tabindex="-1"></a><span class="fu">summary</span>(mod2)</span></code></pre></div>
<pre><code>## ******************************************************************
## Family:  c(&quot;NO&quot;, &quot;Normal&quot;) 
## 
## Call:  gamlss(formula = y ~ session + experiment * phase +  
##     re(random = ~1 | subject), data = datos) 
## 
## Fitting method: RS() 
## 
## ------------------------------------------------------------------
## Mu link function:  identity
## Mu Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)         2.92466    0.14471  20.210   &lt;2e-16 ***
## session             0.00929    0.01820   0.511    0.610    
## experimentB         9.95197    0.23444  42.451   &lt;2e-16 ***
## phase2             -0.30608    0.39279  -0.779    0.436    
## experimentB:phase2 -0.04177    0.20905  -0.200    0.842    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## ------------------------------------------------------------------
## Sigma link function:  log
## Sigma Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept) -0.008407   0.037268  -0.226    0.822
## 
## ------------------------------------------------------------------
## NOTE: Additive smoothing terms exist in the formulas: 
##  i) Std. Error for smoothers are for the linear effect only. 
## ii) Std. Error for the linear terms maybe are not accurate. 
## ------------------------------------------------------------------
## No. of observations in the fit:  360 
## Degrees of Freedom for the fit:  13.79041
##       Residual Deg. of Freedom:  346.2096 
##                       at cycle:  2 
##  
## Global Deviance:     1015.582 
##             AIC:     1043.163 
##             SBC:     1096.754 
## ******************************************************************</code></pre>
<p>A continuación el código para obtener las estimaciones de <span class="math inline">\(\boldsymbol{\Theta}\)</span> con <code>lmer</code> y <code>gamlss</code>.</p>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="sced.html#cb364-1" tabindex="-1"></a>vc <span class="ot">&lt;-</span> <span class="fu">VarCorr</span>(mod1)</span>
<span id="cb364-2"><a href="sced.html#cb364-2" tabindex="-1"></a>vc <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(vc)</span>
<span id="cb364-3"><a href="sced.html#cb364-3" tabindex="-1"></a></span>
<span id="cb364-4"><a href="sced.html#cb364-4" tabindex="-1"></a>theta_lmer <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">fixef</span>(mod1), vc<span class="sc">$</span>sdcor[<span class="dv">2</span><span class="sc">:</span><span class="dv">1</span>])</span>
<span id="cb364-5"><a href="sced.html#cb364-5" tabindex="-1"></a></span>
<span id="cb364-6"><a href="sced.html#cb364-6" tabindex="-1"></a>theta_gamlss <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">coef</span>(mod2)[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">6</span>)],</span>
<span id="cb364-7"><a href="sced.html#cb364-7" tabindex="-1"></a>                  <span class="fu">exp</span>(<span class="fu">coef</span>(mod2, <span class="at">what=</span><span class="st">&#39;sigma&#39;</span>)),</span>
<span id="cb364-8"><a href="sced.html#cb364-8" tabindex="-1"></a>                  <span class="fu">as.numeric</span>(<span class="fu">VarCorr</span>(<span class="fu">getSmo</span>(mod2))[<span class="dv">1</span>, <span class="dv">2</span>]))</span>
<span id="cb364-9"><a href="sced.html#cb364-9" tabindex="-1"></a></span>
<span id="cb364-10"><a href="sced.html#cb364-10" tabindex="-1"></a>theta_true <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="at">beta0=</span><span class="dv">2</span>, <span class="at">beta1=</span><span class="dv">0</span>, <span class="at">beta2=</span><span class="dv">10</span>, <span class="at">beta3=</span><span class="dv">0</span>, <span class="at">beta4=</span><span class="dv">0</span>,</span>
<span id="cb364-11"><a href="sced.html#cb364-11" tabindex="-1"></a>                <span class="at">sigma_y=</span><span class="dv">1</span>, <span class="at">sigma_b0=</span><span class="dv">1</span>)</span>
<span id="cb364-12"><a href="sced.html#cb364-12" tabindex="-1"></a></span>
<span id="cb364-13"><a href="sced.html#cb364-13" tabindex="-1"></a><span class="fu">cbind</span>(theta_true, theta_lmer, theta_gamlss)</span></code></pre></div>
<pre><code>##          theta_true   theta_lmer theta_gamlss
## beta0             2  2.924658593  2.924658593
## beta1             0  0.009290065  0.009290065
## beta2            10  9.951970482  9.951970482
## beta3             0 -0.306076601 -0.306076601
## beta4             0 -0.041773169 -0.041773169
## sigma_y           1  1.009730881  0.991627844
## sigma_b0          1  1.091856686  1.028181000</code></pre>
<p>De la tabla anterior podemos ver que ambos enfoques lograron estimar bastante bien el vector de parámetros <span class="math inline">\(\boldsymbol{\Theta}\)</span>. Para comparar vamos a calcular el <a href="https://en.wikipedia.org/wiki/Mean_squared_error">Mean Squared Error</a>.</p>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="sced.html#cb366-1" tabindex="-1"></a><span class="co"># MSE lmer</span></span>
<span id="cb366-2"><a href="sced.html#cb366-2" tabindex="-1"></a><span class="fu">mean</span>((theta_true <span class="sc">-</span> theta_lmer)<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.1373353</code></pre>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="sced.html#cb368-1" tabindex="-1"></a><span class="co"># MSE gamlss</span></span>
<span id="cb368-2"><a href="sced.html#cb368-2" tabindex="-1"></a><span class="fu">mean</span>((theta_true <span class="sc">-</span> theta_gamlss)<span class="sc">^</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 0.1362398</code></pre>
<p>De los resultados vemos que el MSE de gamlss es ligeramente menor.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="simul-glmm.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="blobs.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/fhernanb/libro_modelos_mixtos/edit/master/805-sced.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
