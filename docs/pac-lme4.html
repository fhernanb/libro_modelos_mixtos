<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Paquete lme4 | Modelos Mixtos con R</title>
  <meta name="description" content="Este libro es para los estudiantes interesados en usar Modelos Mixtos." />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Paquete lme4 | Modelos Mixtos con R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="/images/cover.png" />
  <meta property="og:description" content="Este libro es para los estudiantes interesados en usar Modelos Mixtos." />
  <meta name="github-repo" content="fhernanb/libro_mod_pred" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Paquete lme4 | Modelos Mixtos con R" />
  
  <meta name="twitter:description" content="Este libro es para los estudiantes interesados en usar Modelos Mixtos." />
  <meta name="twitter:image" content="/images/cover.png" />

<meta name="author" content="Freddy Hernández Barajas" />
<meta name="author" content="Jorge Leonardo López Martínez" />


<meta name="date" content="2022-01-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="shiny.html"/>
<link rel="next" href="apli-lme4.html"/>
<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet" />
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.19/datatables.js"></script>
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
<link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
<link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
<script src="libs/selectize-0.12.0/selectize.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Modelos Mixtos con R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Bienvenido</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#estructura-del-libro"><i class="fa fa-check"></i>Estructura del libro</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-y-convenciones"><i class="fa fa-check"></i>Software y convenciones</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#bloques-informativos"><i class="fa fa-check"></i>Bloques informativos</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="reg-lin.html"><a href="reg-lin.html"><i class="fa fa-check"></i><b>1</b> Regresión lineal</a>
<ul>
<li class="chapter" data-level="1.1" data-path="reg-lin.html"><a href="reg-lin.html#modelo-estadístico"><i class="fa fa-check"></i><b>1.1</b> Modelo estadístico</a></li>
<li class="chapter" data-level="1.2" data-path="reg-lin.html"><a href="reg-lin.html#verosimilitud-del-modelo"><i class="fa fa-check"></i><b>1.2</b> Verosimilitud del modelo</a>
<ul>
<li class="chapter" data-level="" data-path="reg-lin.html"><a href="reg-lin.html#ejemplo"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="lmm.html"><a href="lmm.html"><i class="fa fa-check"></i><b>2</b> Modelos Lineales Mixtos</a>
<ul>
<li class="chapter" data-level="2.1" data-path="lmm.html"><a href="lmm.html#entrevista-con-jim-ware-y-nan-laird"><i class="fa fa-check"></i><b>2.1</b> Entrevista con Jim Ware y Nan Laird</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="shiny.html"><a href="shiny.html"><i class="fa fa-check"></i><b>3</b> Aplicaciones shiny</a></li>
<li class="chapter" data-level="4" data-path="pac-lme4.html"><a href="pac-lme4.html"><i class="fa fa-check"></i><b>4</b> Paquete <strong>lme4</strong></a>
<ul>
<li class="chapter" data-level="4.1" data-path="pac-lme4.html"><a href="pac-lme4.html#función-lmer"><i class="fa fa-check"></i><b>4.1</b> Función <code>lmer</code></a></li>
<li class="chapter" data-level="" data-path="pac-lme4.html"><a href="pac-lme4.html#ejemplo-modelo-normal-con-intercepto-aleatorio"><i class="fa fa-check"></i>Ejemplo: modelo normal con intercepto aleatorio</a></li>
<li class="chapter" data-level="" data-path="pac-lme4.html"><a href="pac-lme4.html#ejemplo-recuperando-los-interceptos-aleatorios"><i class="fa fa-check"></i>Ejemplo: recuperando los interceptos aleatorios</a></li>
<li class="chapter" data-level="4.2" data-path="pac-lme4.html"><a href="pac-lme4.html#función-glmer"><i class="fa fa-check"></i><b>4.2</b> Función <code>glmer</code></a></li>
<li class="chapter" data-level="" data-path="pac-lme4.html"><a href="pac-lme4.html#ejemplo-modelo-gamma-con-intercepto-aleatorio"><i class="fa fa-check"></i>Ejemplo: modelo gamma con intercepto aleatorio</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="apli-lme4.html"><a href="apli-lme4.html"><i class="fa fa-check"></i><b>5</b> Aplicación con <code>lme4</code></a>
<ul>
<li class="chapter" data-level="" data-path="apli-lme4.html"><a href="apli-lme4.html#ejercicios"><i class="fa fa-check"></i>Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="pac-nlme.html"><a href="pac-nlme.html"><i class="fa fa-check"></i><b>6</b> Paquete <strong>nlme</strong></a>
<ul>
<li class="chapter" data-level="6.1" data-path="pac-nlme.html"><a href="pac-nlme.html#función-lme"><i class="fa fa-check"></i><b>6.1</b> Función <code>lme</code></a></li>
<li class="chapter" data-level="" data-path="pac-nlme.html"><a href="pac-nlme.html#ejemplo-modelo-normal-con-intercepto-aleatorio-1"><i class="fa fa-check"></i>Ejemplo: modelo normal con intercepto aleatorio</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="apli-nlme.html"><a href="apli-nlme.html"><i class="fa fa-check"></i><b>7</b> Aplicación con <code>nlme</code></a>
<ul>
<li class="chapter" data-level="" data-path="apli-nlme.html"><a href="apli-nlme.html#ejercicios-1"><i class="fa fa-check"></i>Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="apli-rat-pup.html"><a href="apli-rat-pup.html"><i class="fa fa-check"></i><b>8</b> Aplicación rat pup</a></li>
<li class="chapter" data-level="9" data-path="estim.html"><a href="estim.html"><i class="fa fa-check"></i><b>9</b> Métodos de estimación</a>
<ul>
<li class="chapter" data-level="9.1" data-path="estim.html"><a href="estim.html#ml-y-reml"><i class="fa fa-check"></i><b>9.1</b> ML y REML</a></li>
<li><a href="estim.html#ejemplo-comparando-reml-y-ml-usando-lme4">Ejemplo: comparando REML y ML usando <strong>lme4</strong></a></li>
<li><a href="estim.html#ejemplo-comparando-reml-y-ml-usando-nlme">Ejemplo: comparando REML y ML usando <strong>nlme</strong></a></li>
<li class="chapter" data-level="" data-path="estim.html"><a href="estim.html#ejercicios-2"><i class="fa fa-check"></i>Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ph.html"><a href="ph.html"><i class="fa fa-check"></i><b>10</b> Pruebas de hipótesis</a>
<ul>
<li class="chapter" data-level="10.1" data-path="ph.html"><a href="ph.html#prueba-razón-de-verosimilitud"><i class="fa fa-check"></i><b>10.1</b> Prueba razón de verosimilitud</a></li>
<li class="chapter" data-level="10.2" data-path="ph.html"><a href="ph.html#prueba-de-wald"><i class="fa fa-check"></i><b>10.2</b> Prueba de Wald</a></li>
<li class="chapter" data-level="10.3" data-path="ph.html"><a href="ph.html#prueba-de-hipótesis-sobre-los-efectos-fijos"><i class="fa fa-check"></i><b>10.3</b> Prueba de hipótesis sobre los efectos fijos</a>
<ul>
<li class="chapter" data-level="" data-path="ph.html"><a href="ph.html#ejemplo-1"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="ph.html"><a href="ph.html#ejemplo-2"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="ph.html"><a href="ph.html#prueba-de-hipótesis-sobre-componentes-de-varianza"><i class="fa fa-check"></i><b>10.4</b> Prueba de hipótesis sobre componentes de varianza</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="ph.html"><a href="ph.html#componentes-de-varianza-lejos-del-borde"><i class="fa fa-check"></i><b>10.4.1</b> Componentes de varianza lejos del borde</a></li>
<li class="chapter" data-level="10.4.2" data-path="ph.html"><a href="ph.html#componentes-de-varianza-en-el-borde"><i class="fa fa-check"></i><b>10.4.2</b> Componentes de varianza en el borde</a></li>
<li class="chapter" data-level="" data-path="ph.html"><a href="ph.html#ejemplo-3"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="ph.html"><a href="ph.html#ejemplo-4"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="ph.html"><a href="ph.html#ejercicios-3"><i class="fa fa-check"></i>Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="reg-diagnos.html"><a href="reg-diagnos.html"><i class="fa fa-check"></i><b>11</b> Diagnóstico del modelo de regresión de efectos mixtos</a>
<ul>
<li class="chapter" data-level="11.1" data-path="reg-diagnos.html"><a href="reg-diagnos.html#supuestos-del-modelo-de-regresión"><i class="fa fa-check"></i><b>11.1</b> Supuestos del modelo de regresión</a></li>
<li class="chapter" data-level="11.2" data-path="reg-diagnos.html"><a href="reg-diagnos.html#los-residuos"><i class="fa fa-check"></i><b>11.2</b> Los residuos</a></li>
<li class="chapter" data-level="11.3" data-path="reg-diagnos.html"><a href="reg-diagnos.html#diagnóstico-del-modelo-de-regresión-prueba-de-hipótesis-e-inferencia-visual"><i class="fa fa-check"></i><b>11.3</b> Diagnóstico del modelo de regresión: prueba de hipótesis e inferencia visual</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="reg-diagnos.html"><a href="reg-diagnos.html#ajustando-el-modelo"><i class="fa fa-check"></i><b>11.3.1</b> Ajustando el modelo</a></li>
<li class="chapter" data-level="11.3.2" data-path="reg-diagnos.html"><a href="reg-diagnos.html#varianza-constante-de-los-residuos-mediante-inferencia-visual"><i class="fa fa-check"></i><b>11.3.2</b> Varianza constante de los residuos mediante inferencia visual</a></li>
<li class="chapter" data-level="11.3.3" data-path="reg-diagnos.html"><a href="reg-diagnos.html#varianza-constante-de-los-residuos-mediante-prueba-de-hipótesis"><i class="fa fa-check"></i><b>11.3.3</b> Varianza constante de los residuos mediante prueba de hipótesis</a></li>
<li class="chapter" data-level="" data-path="reg-diagnos.html"><a href="reg-diagnos.html#ejemplo-5"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="11.3.4" data-path="reg-diagnos.html"><a href="reg-diagnos.html#distribución-normal-de-los-residuos-mediante-inferencia-visual"><i class="fa fa-check"></i><b>11.3.4</b> Distribución normal de los residuos mediante inferencia visual</a></li>
<li class="chapter" data-level="" data-path="reg-diagnos.html"><a href="reg-diagnos.html#ejemplo-6"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="11.3.5" data-path="reg-diagnos.html"><a href="reg-diagnos.html#distribución-normal-de-los-residuos-mediante-prueba-de-hipótesis"><i class="fa fa-check"></i><b>11.3.5</b> Distribución normal de los residuos mediante prueba de hipótesis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="var-fun.html"><a href="var-fun.html"><i class="fa fa-check"></i><b>12</b> Modelando la heterocedasticidad</a></li>
<li class="chapter" data-level="13" data-path="glmm.html"><a href="glmm.html"><i class="fa fa-check"></i><b>13</b> Modelos Lineales Generalizados Mixtos</a>
<ul>
<li class="chapter" data-level="13.1" data-path="glmm.html"><a href="glmm.html#videos-de-apoyo"><i class="fa fa-check"></i><b>13.1</b> Videos de apoyo</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="pac-glmmTMB.html"><a href="pac-glmmTMB.html"><i class="fa fa-check"></i><b>14</b> Paquete <strong>glmmTMB</strong></a>
<ul>
<li class="chapter" data-level="14.1" data-path="pac-glmmTMB.html"><a href="pac-glmmTMB.html#función-glmmtmb"><i class="fa fa-check"></i><b>14.1</b> Función <code>glmmTMB</code></a></li>
<li class="chapter" data-level="" data-path="pac-glmmTMB.html"><a href="pac-glmmTMB.html#ejemplo-modelo-normal-con-intercepto-aleatorio-2"><i class="fa fa-check"></i>Ejemplo: modelo normal con intercepto aleatorio</a></li>
<li class="chapter" data-level="" data-path="pac-glmmTMB.html"><a href="pac-glmmTMB.html#ejemplo-recuperando-los-interceptos-aleatorios-1"><i class="fa fa-check"></i>Ejemplo: recuperando los interceptos aleatorios</a></li>
<li class="chapter" data-level="" data-path="pac-glmmTMB.html"><a href="pac-glmmTMB.html#ejemplo-modelo-gamma-con-intercepto-aleatorio-1"><i class="fa fa-check"></i>Ejemplo: modelo gamma con intercepto aleatorio</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="pac-glmm.html"><a href="pac-glmm.html"><i class="fa fa-check"></i><b>15</b> Paquete <strong>glmm</strong></a>
<ul>
<li class="chapter" data-level="15.1" data-path="pac-glmm.html"><a href="pac-glmm.html#función-glmm"><i class="fa fa-check"></i><b>15.1</b> Función <code>glmm</code></a></li>
<li class="chapter" data-level="" data-path="pac-glmm.html"><a href="pac-glmm.html#ejemplo-modelo-poisson-con-intercepto-aleatorio"><i class="fa fa-check"></i>Ejemplo: modelo Poisson con intercepto aleatorio</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="pac-MASS.html"><a href="pac-MASS.html"><i class="fa fa-check"></i><b>16</b> Paquete <strong>MASS</strong></a>
<ul>
<li class="chapter" data-level="16.1" data-path="pac-MASS.html"><a href="pac-MASS.html#función-glmmpql"><i class="fa fa-check"></i><b>16.1</b> Función <code>glmmPQL</code></a></li>
<li class="chapter" data-level="" data-path="pac-MASS.html"><a href="pac-MASS.html#ejemplo-modelo-bernoulli-binomial-con-intercepto-aleatorio"><i class="fa fa-check"></i>Ejemplo: modelo Bernoulli (binomial) con intercepto aleatorio</a></li>
<li class="chapter" data-level="16.2" data-path="pac-MASS.html"><a href="pac-MASS.html#what-it-means-for-aic-na-in-glmmpql-mass-summary-output"><i class="fa fa-check"></i><b>16.2</b> what it means for AIC NA in glmmPQL (MASS) summary output?</a></li>
<li class="chapter" data-level="16.3" data-path="pac-MASS.html"><a href="pac-MASS.html#two-questions-on-the-results-from-glmmpqlmass"><i class="fa fa-check"></i><b>16.3</b> Two questions on the results from glmmPQL(MASS)</a></li>
<li class="chapter" data-level="16.4" data-path="pac-MASS.html"><a href="pac-MASS.html#how-do-i-interpret-the-variance-of-random-effect-in-a-generalized-linear-mixed-model"><i class="fa fa-check"></i><b>16.4</b> How do I interpret the variance of random effect in a generalized linear mixed model?</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="glmm_poisson.html"><a href="glmm_poisson.html"><i class="fa fa-check"></i><b>17</b> GLMM Poisson</a></li>
<li class="chapter" data-level="18" data-path="glmm_gamma.html"><a href="glmm_gamma.html"><i class="fa fa-check"></i><b>18</b> GLMM gamma</a></li>
<li class="chapter" data-level="19" data-path="simul-glmm.html"><a href="simul-glmm.html"><i class="fa fa-check"></i><b>19</b> Simulación de glmm</a></li>
<li class="chapter" data-level="20" data-path="blobs.html"><a href="blobs.html"><i class="fa fa-check"></i><b>20</b> Otro material interesante</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Modelos Mixtos con R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="pac-lme4" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Paquete <strong>lme4</strong></h1>
<p>El paquete <strong>lme4</strong> de <span class="citation">Bates et al. (<a href="#ref-R-lme4" role="doc-biblioref">2021</a>)</span> es uno de los paquetes más completos para modelos mixtos. Al visitar este <a href="https://cran.r-project.org/web/packages/lme4/">enlace</a> se encontrará la página de apoyo del paquete, allí se puede consultar el manual de referencia y las viñetas.</p>
<div id="función-lmer" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Función <code>lmer</code></h2>
<p>La función <code>lmer</code> es la principal función del paquete <strong>lme4</strong>. Esta función sirve para ajustar un modelo mixto y su estructura es la siguiente:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="pac-lme4.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lmer</span>(formula, <span class="at">data =</span> <span class="cn">NULL</span>, <span class="at">REML =</span> <span class="cn">TRUE</span>, <span class="at">control =</span> <span class="fu">lmerControl</span>(),</span>
<span id="cb14-2"><a href="pac-lme4.html#cb14-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">start =</span> <span class="cn">NULL</span>, <span class="at">verbose =</span> 0L, subset, weights, na.action,</span>
<span id="cb14-3"><a href="pac-lme4.html#cb14-3" aria-hidden="true" tabindex="-1"></a>     offset, <span class="at">contrasts =</span> <span class="cn">NULL</span>, <span class="at">devFunOnly =</span> <span class="cn">FALSE</span>, ...)</span></code></pre></div>
<p>Los principales argumentos de la función son:</p>
<ul>
<li><code>formula</code>: es una fórmula similar a la usada en el modelo lineal clásico. Un ejemplo de fórmula sería <code>y ~ 1 + x1 + x2 + (1 + x2 | grupo)</code> con la cual se indican los efectos fijos y los efectos aleatorios del modelo. Más abajo hay una tabla con más detalles sobre la fórmula.</li>
<li><code>data</code>: marco de datos donde están las variables.<br />
</li>
<li><code>REML</code>: valor lógico que sirve para indicar si queremos estimaciones maximizando la <a href="https://en.wikipedia.org/wiki/Restricted_maximum_likelihood">verosimilitud restringida</a> o la verosimilitud usual.</li>
</ul>
<p>La siguiente imagen corresponde a la tabla 2 de la viñeta <a href="https://cran.r-project.org/web/packages/lme4/vignettes/lmer.pdf">Fitting Linear Mixed-Effects Models using lme4</a>. En la tabla las dos primeras columnas muestran formas equivalentes de incluir las estructuras de modelos mixtos más comunes.</p>
<p><img src="images/tabla2_viñeta2_paq_lmer.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="ejemplo-modelo-normal-con-intercepto-aleatorio" class="section level2 unnumbered">
<h2>Ejemplo: modelo normal con intercepto aleatorio</h2>
<p>En este ejemplo vamos a simular observaciones <span class="math inline">\(n_i=50\)</span> observaciones para <span class="math inline">\(G=10\)</span> grupos (en total 500 obs) que tengan la estructura mostrada abajo. El objetivo del ejemplo es ilustrar el uso de la función <code>lmer</code> para estimar los parámetros del modelo.</p>
<p><span class="math display">\[\begin{align*} 
y_{ij} &amp;\sim  N(\mu_{ij}, \sigma^2_y) \\ 
\mu_{ij} &amp;= 4 - 6 x_{ij} + b_{0i} \\
\sigma^2_y &amp;= 16 \\
b_{0} &amp;\sim N(0, \sigma^2_{b0}=625) \\
x_{ij} &amp;\sim U(-5, 6)
\end{align*}\]</span></p>
<p>El vector de parámetros de este modelo es <span class="math inline">\(\boldsymbol{\Theta}=(\beta_0=4, \beta_1=-6, \sigma_y=4, \sigma_{b0}=25)^\top\)</span>.</p>
<div style="-moz-box-shadow: 1px 1px 3px 2px #000000;
  -webkit-box-shadow: 1px 1px 3px 2px #000000;
  box-shadow:         1px 1px 3px 2px #000000;">

<div class="rmdexercise">
Solución.
</div>
</div>
<p>El código para simular las 500 observaciones se muestra a continuación. Observe que se fijó la semilla en dos ocasiones para que el lector pueda replicar el ejemplo y obtener los mismos resultados.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="pac-lme4.html#cb15-1" aria-hidden="true" tabindex="-1"></a>ni <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb15-2"><a href="pac-lme4.html#cb15-2" aria-hidden="true" tabindex="-1"></a>G <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb15-3"><a href="pac-lme4.html#cb15-3" aria-hidden="true" tabindex="-1"></a>nobs <span class="ot">&lt;-</span> ni <span class="sc">*</span> G</span>
<span id="cb15-4"><a href="pac-lme4.html#cb15-4" aria-hidden="true" tabindex="-1"></a>grupo <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span>G, <span class="at">each=</span>ni))</span>
<span id="cb15-5"><a href="pac-lme4.html#cb15-5" aria-hidden="true" tabindex="-1"></a>obs <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span>ni, <span class="at">times=</span>G)</span>
<span id="cb15-6"><a href="pac-lme4.html#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234567</span>)</span>
<span id="cb15-7"><a href="pac-lme4.html#cb15-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n=</span>nobs, <span class="at">min=</span><span class="sc">-</span><span class="dv">5</span>, <span class="at">max=</span><span class="dv">6</span>)</span>
<span id="cb15-8"><a href="pac-lme4.html#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234567</span>)</span>
<span id="cb15-9"><a href="pac-lme4.html#cb15-9" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n=</span>G, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="fu">sqrt</span>(<span class="dv">625</span>)) <span class="co"># Intercepto aleatorio</span></span>
<span id="cb15-10"><a href="pac-lme4.html#cb15-10" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="at">x=</span>b0, <span class="at">each=</span>ni)               <span class="co"># El mismo intercepto aleatorio pero repetido</span></span>
<span id="cb15-11"><a href="pac-lme4.html#cb15-11" aria-hidden="true" tabindex="-1"></a>media <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="sc">-</span> <span class="dv">6</span> <span class="sc">*</span> x <span class="sc">+</span> b0</span>
<span id="cb15-12"><a href="pac-lme4.html#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234567</span>)</span>
<span id="cb15-13"><a href="pac-lme4.html#cb15-13" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n=</span>nobs, <span class="at">mean=</span>media, <span class="at">sd=</span><span class="fu">sqrt</span>(<span class="dv">16</span>))</span>
<span id="cb15-14"><a href="pac-lme4.html#cb15-14" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(obs, grupo, b0, x, media, y)</span></code></pre></div>
<p>Vamos a explorar los datos simulados.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="pac-lme4.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rmarkdown)</span>
<span id="cb16-2"><a href="pac-lme4.html#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paged_table</span>(datos, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">rows.print =</span> <span class="dv">6</span>))</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["obs"],"name":[1],"type":["int"],"align":["right"]},{"label":["grupo"],"name":[2],"type":["fct"],"align":["left"]},{"label":["b0"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["x"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["media"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["y"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"1","3":"3.917594","4":"1.184869218","5":"0.8083789","6":"1.43519400"},{"1":"2","2":"1","3":"3.917594","4":"2.991483548","5":"-10.0313071","6":"-4.53606230"},{"1":"3","2":"1","3":"3.917594","4":"5.067748369","5":"-22.4888960","6":"-19.56621501"},{"1":"4","2":"1","3":"3.917594","4":"-4.673361925","5":"35.9577658","6":"30.55456207"},{"1":"5","2":"1","3":"3.917594","4":"3.442606741","5":"-12.7380462","6":"-12.77210606"},{"1":"6","2":"1","3":"3.917594","4":"0.280593764","5":"6.2340316","6":"7.51795910"},{"1":"7","2":"1","3":"3.917594","4":"-4.027824399","5":"32.0845406","6":"24.97194699"},{"1":"8","2":"1","3":"3.917594","4":"4.492404519","5":"-19.0368329","6":"-15.39881755"},{"1":"9","2":"1","3":"3.917594","4":"0.462633627","5":"5.1417925","6":"1.46417512"},{"1":"10","2":"1","3":"3.917594","4":"4.388544320","5":"-18.4136717","6":"-19.04453102"},{"1":"11","2":"1","3":"3.917594","4":"1.884767291","5":"-3.3910095","6":"1.01698004"},{"1":"12","2":"1","3":"3.917594","4":"-2.344022444","5":"21.9817289","6":"28.14809497"},{"1":"13","2":"1","3":"3.917594","4":"-4.585412808","5":"35.4300711","6":"33.91721249"},{"1":"14","2":"1","3":"3.917594","4":"0.682522679","5":"3.8224582","6":"1.82817876"},{"1":"15","2":"1","3":"3.917594","4":"4.003036704","5":"-16.1006260","6":"-18.26581068"},{"1":"16","2":"1","3":"3.917594","4":"0.446374461","5":"5.2393475","6":"7.40703600"},{"1":"17","2":"1","3":"3.917594","4":"-3.031637395","5":"26.1074186","6":"20.27739040"},{"1":"18","2":"1","3":"3.917594","4":"4.670564509","5":"-20.1057928","6":"-19.63795106"},{"1":"19","2":"1","3":"3.917594","4":"-0.189251656","5":"9.0531042","6":"8.49022181"},{"1":"20","2":"1","3":"3.917594","4":"2.988983728","5":"-10.0163081","6":"-9.83892536"},{"1":"21","2":"1","3":"3.917594","4":"4.512454619","5":"-19.1571335","6":"-22.33275977"},{"1":"22","2":"1","3":"3.917594","4":"-1.709819791","5":"18.1765130","6":"20.56694857"},{"1":"23","2":"1","3":"3.917594","4":"5.322549108","5":"-24.0177004","6":"-27.98755897"},{"1":"24","2":"1","3":"3.917594","4":"-0.311049437","5":"9.7838909","6":"12.74378171"},{"1":"25","2":"1","3":"3.917594","4":"-1.121008729","5":"14.6436466","6":"12.29521140"},{"1":"26","2":"1","3":"3.917594","4":"-0.376186716","5":"10.1747145","6":"9.64002011"},{"1":"27","2":"1","3":"3.917594","4":"-1.600546498","5":"17.5208732","6":"19.15148400"},{"1":"28","2":"1","3":"3.917594","4":"-4.219219377","5":"33.2329105","6":"34.16267943"},{"1":"29","2":"1","3":"3.917594","4":"-1.764330979","5":"18.5035801","6":"13.37376958"},{"1":"30","2":"1","3":"3.917594","4":"3.830971485","5":"-15.0682347","6":"-12.97441079"},{"1":"31","2":"1","3":"3.917594","4":"2.766703130","5":"-8.6826245","6":"-7.91907953"},{"1":"32","2":"1","3":"3.917594","4":"5.716572118","5":"-26.3818385","6":"-27.93608972"},{"1":"33","2":"1","3":"3.917594","4":"-4.202629486","5":"33.1333711","6":"30.74344598"},{"1":"34","2":"1","3":"3.917594","4":"5.984683732","5":"-27.9905082","6":"-26.22615073"},{"1":"35","2":"1","3":"3.917594","4":"1.012097349","5":"1.8450101","6":"-0.68465777"},{"1":"36","2":"1","3":"3.917594","4":"-2.896180371","5":"25.2946765","6":"21.63948297"},{"1":"37","2":"1","3":"3.917594","4":"-0.115501271","5":"8.6106019","6":"0.28065945"},{"1":"38","2":"1","3":"3.917594","4":"2.264097470","5":"-5.6669906","6":"-7.49291012"},{"1":"39","2":"1","3":"3.917594","4":"0.694541345","5":"3.7503462","6":"2.25730189"},{"1":"40","2":"1","3":"3.917594","4":"4.234606953","5":"-17.4900475","6":"-18.54146485"},{"1":"41","2":"1","3":"3.917594","4":"-2.650125926","5":"23.8183498","6":"22.60053653"},{"1":"42","2":"1","3":"3.917594","4":"-1.398902564","5":"16.3110096","6":"17.09342979"},{"1":"43","2":"1","3":"3.917594","4":"2.974444892","5":"-9.9290751","6":"-11.50807342"},{"1":"44","2":"1","3":"3.917594","4":"4.087809406","5":"-16.6092622","6":"-10.17286535"},{"1":"45","2":"1","3":"3.917594","4":"-3.234659956","5":"27.3255540","6":"26.50082697"},{"1":"46","2":"1","3":"3.917594","4":"4.664524420","5":"-20.0695523","6":"-20.09251736"},{"1":"47","2":"1","3":"3.917594","4":"3.473759032","5":"-12.9249600","6":"-16.95743152"},{"1":"48","2":"1","3":"3.917594","4":"-4.040280648","5":"32.1592781","6":"32.77949565"},{"1":"49","2":"1","3":"3.917594","4":"-1.935781488","5":"19.5322832","6":"27.44153735"},{"1":"50","2":"1","3":"3.917594","4":"-2.760826456","5":"24.4825530","6":"28.08131275"},{"1":"1","2":"2","3":"34.345280","4":"-0.084866327","5":"38.8544777","6":"38.35308338"},{"1":"2","2":"2","3":"34.345280","4":"5.614929088","5":"4.6557053","6":"1.76993348"},{"1":"3","2":"2","3":"34.345280","4":"2.240592304","5":"24.9017260","6":"29.69521948"},{"1":"4","2":"2","3":"34.345280","4":"-0.988280832","5":"44.2749648","6":"49.22047680"},{"1":"5","2":"2","3":"34.345280","4":"1.510930033","5":"29.2796996","6":"27.08764738"},{"1":"6","2":"2","3":"34.345280","4":"-3.466786264","5":"59.1459974","6":"57.70712656"},{"1":"7","2":"2","3":"34.345280","4":"-3.901738453","5":"61.7557105","6":"59.76011764"},{"1":"8","2":"2","3":"34.345280","4":"0.653007731","5":"34.4272334","6":"33.03248106"},{"1":"9","2":"2","3":"34.345280","4":"2.696386594","5":"22.1669602","6":"19.94955398"},{"1":"10","2":"2","3":"34.345280","4":"-1.447189400","5":"47.0284162","6":"53.22011016"},{"1":"11","2":"2","3":"34.345280","4":"1.332619106","5":"30.3495652","6":"23.75679634"},{"1":"12","2":"2","3":"34.345280","4":"4.374563009","5":"12.0979017","6":"9.85748964"},{"1":"13","2":"2","3":"34.345280","4":"-1.163202297","5":"45.3244936","6":"48.66964954"},{"1":"14","2":"2","3":"34.345280","4":"1.056103997","5":"32.0086558","6":"23.57972385"},{"1":"15","2":"2","3":"34.345280","4":"-1.973976494","5":"50.1891388","6":"51.34632947"},{"1":"16","2":"2","3":"34.345280","4":"3.751077967","5":"15.8388120","6":"10.84979383"},{"1":"17","2":"2","3":"34.345280","4":"2.374684291","5":"24.0971740","6":"26.92683758"},{"1":"18","2":"2","3":"34.345280","4":"5.264995553","5":"6.7553065","6":"0.09165137"},{"1":"19","2":"2","3":"34.345280","4":"-2.100870574","5":"50.9505032","6":"45.08558957"},{"1":"20","2":"2","3":"34.345280","4":"0.126408174","5":"37.5868307","6":"38.74827750"},{"1":"21","2":"2","3":"34.345280","4":"-3.015474602","5":"56.4381274","6":"60.15885662"},{"1":"22","2":"2","3":"34.345280","4":"-0.664483852","5":"42.3321829","6":"43.23115439"},{"1":"23","2":"2","3":"34.345280","4":"-4.794860288","5":"67.1144415","6":"61.73852621"},{"1":"24","2":"2","3":"34.345280","4":"1.461844166","5":"29.5742148","6":"32.15469828"},{"1":"25","2":"2","3":"34.345280","4":"-1.435752891","5":"46.9597971","6":"39.34733380"},{"1":"26","2":"2","3":"34.345280","4":"-1.458029503","5":"47.0934568","6":"50.66524499"},{"1":"27","2":"2","3":"34.345280","4":"-1.100752227","5":"44.9497931","6":"47.78640034"},{"1":"28","2":"2","3":"34.345280","4":"1.656939213","5":"28.4036445","6":"27.77997652"},{"1":"29","2":"2","3":"34.345280","4":"-0.640354327","5":"42.1874057","6":"50.95549014"},{"1":"30","2":"2","3":"34.345280","4":"-0.044597118","5":"38.6128625","6":"37.99781118"},{"1":"31","2":"2","3":"34.345280","4":"-0.815695921","5":"43.2394553","6":"45.96541230"},{"1":"32","2":"2","3":"34.345280","4":"-4.902496274","5":"67.7602574","6":"69.30423028"},{"1":"33","2":"2","3":"34.345280","4":"1.352943770","5":"30.2276172","6":"30.41991931"},{"1":"34","2":"2","3":"34.345280","4":"3.757894848","5":"15.7979107","6":"16.91753434"},{"1":"35","2":"2","3":"34.345280","4":"-1.188347607","5":"45.4753654","6":"50.31907283"},{"1":"36","2":"2","3":"34.345280","4":"1.597899244","5":"28.7578843","6":"32.66871959"},{"1":"37","2":"2","3":"34.345280","4":"5.408229429","5":"5.8959032","6":"2.14594988"},{"1":"38","2":"2","3":"34.345280","4":"-1.281983035","5":"46.0371780","6":"44.24678703"},{"1":"39","2":"2","3":"34.345280","4":"-0.398430760","5":"40.7358643","6":"33.09410249"},{"1":"40","2":"2","3":"34.345280","4":"-2.509114270","5":"53.3999654","6":"61.45807270"},{"1":"41","2":"2","3":"34.345280","4":"0.474805347","5":"35.4964477","6":"33.33917304"},{"1":"42","2":"2","3":"34.345280","4":"3.664906789","5":"16.3558391","6":"18.99729300"},{"1":"43","2":"2","3":"34.345280","4":"-3.276311646","5":"58.0031497","6":"56.06772300"},{"1":"44","2":"2","3":"34.345280","4":"-3.646872754","5":"60.2265163","6":"61.13065211"},{"1":"45","2":"2","3":"34.345280","4":"1.177718518","5":"31.2789687","6":"29.12005653"},{"1":"46","2":"2","3":"34.345280","4":"2.521580628","5":"23.2157960","6":"15.14410630"},{"1":"47","2":"2","3":"34.345280","4":"5.735965873","5":"3.9294845","6":"5.51408875"},{"1":"48","2":"2","3":"34.345280","4":"0.597280205","5":"34.7615986","6":"31.11644803"},{"1":"49","2":"2","3":"34.345280","4":"3.974430964","5":"14.4986940","6":"19.32520744"},{"1":"50","2":"2","3":"34.345280","4":"0.940834068","5":"32.7002754","6":"30.83697699"},{"1":"1","2":"3","3":"18.266756","4":"-0.048638293","5":"22.5585858","6":"21.81516392"},{"1":"2","2":"3","3":"18.266756","4":"2.564233347","5":"6.8813560","6":"9.37517235"},{"1":"3","2":"3","3":"18.266756","4":"-2.411496335","5":"36.7357341","6":"33.44729504"},{"1":"4","2":"3","3":"18.266756","4":"1.281425769","5":"14.5782015","6":"21.05209500"},{"1":"5","2":"3","3":"18.266756","4":"4.730755689","5":"-6.1177780","6":"-6.98868077"},{"1":"6","2":"3","3":"18.266756","4":"5.736885634","5":"-12.1545577","6":"-12.55689905"},{"1":"7","2":"3","3":"18.266756","4":"4.810250446","5":"-6.5947466","6":"-9.24132889"},{"1":"8","2":"3","3":"18.266756","4":"4.108045165","5":"-2.3815149","6":"-0.41851248"},{"1":"9","2":"3","3":"18.266756","4":"-1.789743795","5":"33.0052189","6":"29.62969560"},{"1":"10","2":"3","3":"18.266756","4":"-3.632652176","5":"44.0626691","6":"44.89607929"},{"1":"11","2":"3","3":"18.266756","4":"-1.045179637","5":"28.5378339","6":"29.24165289"},{"1":"12","2":"3","3":"18.266756","4":"0.640184637","5":"18.4256483","6":"13.53624778"},{"1":"13","2":"3","3":"18.266756","4":"-1.601819022","5":"31.8776702","6":"28.76455074"},{"1":"14","2":"3","3":"18.266756","4":"4.826676680","5":"-6.6933040","6":"0.45156701"},{"1":"15","2":"3","3":"18.266756","4":"-0.999720750","5":"28.2650806","6":"26.81889904"},{"1":"16","2":"3","3":"18.266756","4":"-3.223894780","5":"41.6101248","6":"35.02629150"},{"1":"17","2":"3","3":"18.266756","4":"-1.813639506","5":"33.1485931","6":"31.50495964"},{"1":"18","2":"3","3":"18.266756","4":"-3.850045066","5":"45.3670265","6":"36.62677671"},{"1":"19","2":"3","3":"18.266756","4":"5.330976025","5":"-9.7191001","6":"-11.27342533"},{"1":"20","2":"3","3":"18.266756","4":"1.752256202","5":"11.7532189","6":"7.99649276"},{"1":"21","2":"3","3":"18.266756","4":"-4.453777205","5":"48.9894193","6":"48.05109137"},{"1":"22","2":"3","3":"18.266756","4":"0.308834229","5":"20.4137507","6":"19.80574828"},{"1":"23","2":"3","3":"18.266756","4":"-1.835249566","5":"33.2782535","6":"32.41947382"},{"1":"24","2":"3","3":"18.266756","4":"2.332920374","5":"8.2692339","6":"2.18929544"},{"1":"25","2":"3","3":"18.266756","4":"3.783542075","5":"-0.4344964","6":"2.55281221"},{"1":"26","2":"3","3":"18.266756","4":"1.466324901","5":"13.4688067","6":"21.55312089"},{"1":"27","2":"3","3":"18.266756","4":"-4.806964407","5":"51.1085425","6":"51.63894934"},{"1":"28","2":"3","3":"18.266756","4":"4.782499440","5":"-6.4282405","6":"-2.23681178"},{"1":"29","2":"3","3":"18.266756","4":"1.752055296","5":"11.7544243","6":"11.49663370"},{"1":"30","2":"3","3":"18.266756","4":"-3.737477744","5":"44.6916226","6":"47.37627748"},{"1":"31","2":"3","3":"18.266756","4":"-3.832326959","5":"45.2607178","6":"45.81773637"},{"1":"32","2":"3","3":"18.266756","4":"-0.472306298","5":"25.1005939","6":"23.92371180"},{"1":"33","2":"3","3":"18.266756","4":"3.363805548","5":"2.0839228","6":"0.05148613"},{"1":"34","2":"3","3":"18.266756","4":"5.591532835","5":"-11.2824409","6":"-16.64063124"},{"1":"35","2":"3","3":"18.266756","4":"-4.473481741","5":"49.1076465","6":"52.81697481"},{"1":"36","2":"3","3":"18.266756","4":"-3.650895170","5":"44.1721271","6":"48.84599936"},{"1":"37","2":"3","3":"18.266756","4":"-4.215776561","5":"47.5614155","6":"47.08687276"},{"1":"38","2":"3","3":"18.266756","4":"-3.146681954","5":"41.1468478","6":"39.64372663"},{"1":"39","2":"3","3":"18.266756","4":"1.756532468","5":"11.7275613","6":"14.99768356"},{"1":"40","2":"3","3":"18.266756","4":"-1.546425587","5":"31.5453096","6":"34.64264223"},{"1":"41","2":"3","3":"18.266756","4":"4.062478121","5":"-2.1081126","6":"-2.10714327"},{"1":"42","2":"3","3":"18.266756","4":"2.414648525","5":"7.7788649","6":"0.91358276"},{"1":"43","2":"3","3":"18.266756","4":"1.478013823","5":"13.3986732","6":"15.24933711"},{"1":"44","2":"3","3":"18.266756","4":"0.068220430","5":"21.8574335","6":"24.13642852"},{"1":"45","2":"3","3":"18.266756","4":"-4.015746174","5":"46.3612331","6":"43.47629024"},{"1":"46","2":"3","3":"18.266756","4":"0.155604519","5":"21.3331290","6":"18.91369285"},{"1":"47","2":"3","3":"18.266756","4":"3.146331277","5":"3.3887684","6":"9.24734411"},{"1":"48","2":"3","3":"18.266756","4":"0.813888297","5":"17.3834263","6":"18.35532032"},{"1":"49","2":"3","3":"18.266756","4":"-4.686360139","5":"50.3849169","6":"52.56414948"},{"1":"50","2":"3","3":"18.266756","4":"5.754624297","5":"-12.2609897","6":"-11.34047113"},{"1":"1","2":"4","3":"-33.770023","4":"3.954629540","5":"-53.4978004","6":"-50.86690069"},{"1":"2","2":"4","3":"-33.770023","4":"0.332206871","5":"-31.7632644","6":"-38.36156543"},{"1":"3","2":"4","3":"-33.770023","4":"3.369733363","5":"-49.9884233","6":"-57.66014845"},{"1":"4","2":"4","3":"-33.770023","4":"5.926987591","5":"-65.3319487","6":"-65.10217350"},{"1":"5","2":"4","3":"-33.770023","4":"-0.181458506","5":"-28.6812721","6":"-29.39522301"},{"1":"6","2":"4","3":"-33.770023","4":"1.284710440","5":"-37.4782858","6":"-37.36107610"},{"1":"7","2":"4","3":"-33.770023","4":"5.843921100","5":"-64.8335498","6":"-56.20462951"},{"1":"8","2":"4","3":"-33.770023","4":"3.613059368","5":"-51.4483794","6":"-54.28041115"},{"1":"9","2":"4","3":"-33.770023","4":"-0.172117867","5":"-28.7373160","6":"-32.38995805"},{"1":"10","2":"4","3":"-33.770023","4":"-1.686427187","5":"-19.6514600","6":"-21.18223621"},{"1":"11","2":"4","3":"-33.770023","4":"3.274409224","5":"-49.4164785","6":"-46.07635717"},{"1":"12","2":"4","3":"-33.770023","4":"-1.851085579","5":"-18.6635097","6":"-14.69212323"},{"1":"13","2":"4","3":"-33.770023","4":"2.152740641","5":"-42.6864670","6":"-37.17514560"},{"1":"14","2":"4","3":"-33.770023","4":"3.668410014","5":"-51.7804833","6":"-58.10443027"},{"1":"15","2":"4","3":"-33.770023","4":"0.710891800","5":"-34.0353740","6":"-34.21554860"},{"1":"16","2":"4","3":"-33.770023","4":"-0.538453247","5":"-26.5393037","6":"-25.73294776"},{"1":"17","2":"4","3":"-33.770023","4":"1.712476700","5":"-40.0448834","6":"-40.38128786"},{"1":"18","2":"4","3":"-33.770023","4":"2.562366992","5":"-45.1442251","6":"-48.12802362"},{"1":"19","2":"4","3":"-33.770023","4":"4.757421032","5":"-58.3145494","6":"-58.69008894"},{"1":"20","2":"4","3":"-33.770023","4":"0.835106977","5":"-34.7806650","6":"-35.18735823"},{"1":"21","2":"4","3":"-33.770023","4":"4.194798961","5":"-54.9388169","6":"-53.44658415"},{"1":"22","2":"4","3":"-33.770023","4":"3.054502665","5":"-48.0970392","6":"-44.35345306"},{"1":"23","2":"4","3":"-33.770023","4":"-3.083209140","5":"-11.2707683","6":"-7.72213974"},{"1":"24","2":"4","3":"-33.770023","4":"-3.313995838","5":"-9.8860481","6":"-14.69336075"},{"1":"25","2":"4","3":"-33.770023","4":"-1.400560560","5":"-21.3666598","6":"-26.21794013"},{"1":"26","2":"4","3":"-33.770023","4":"-3.815427588","5":"-6.8774576","6":"-10.93831884"},{"1":"27","2":"4","3":"-33.770023","4":"-4.691579162","5":"-1.6205482","6":"-0.80508634"},{"1":"28","2":"4","3":"-33.770023","4":"4.689541082","5":"-57.9072697","6":"-51.41245483"},{"1":"29","2":"4","3":"-33.770023","4":"5.758251651","5":"-64.3195331","6":"-63.69522594"},{"1":"30","2":"4","3":"-33.770023","4":"-3.699046517","5":"-7.5757441","6":"-7.75983075"},{"1":"31","2":"4","3":"-33.770023","4":"-1.756831613","5":"-19.2290335","6":"-22.26596253"},{"1":"32","2":"4","3":"-33.770023","4":"4.160945239","5":"-54.7356946","6":"-53.45275781"},{"1":"33","2":"4","3":"-33.770023","4":"3.200386703","5":"-48.9723434","6":"-44.58606433"},{"1":"34","2":"4","3":"-33.770023","4":"4.809908913","5":"-58.6294766","6":"-66.24751857"},{"1":"35","2":"4","3":"-33.770023","4":"-1.543318236","5":"-20.5101138","6":"-8.73376627"},{"1":"36","2":"4","3":"-33.770023","4":"1.208709778","5":"-37.0222818","6":"-41.02093977"},{"1":"37","2":"4","3":"-33.770023","4":"1.483537438","5":"-38.6712478","6":"-36.75751987"},{"1":"38","2":"4","3":"-33.770023","4":"1.096359043","5":"-36.3481774","6":"-28.48862089"},{"1":"39","2":"4","3":"-33.770023","4":"-1.758384625","5":"-19.2197154","6":"-22.63579953"},{"1":"40","2":"4","3":"-33.770023","4":"-4.567334876","5":"-2.3660139","6":"-11.90996375"},{"1":"41","2":"4","3":"-33.770023","4":"-4.760203588","5":"-1.2088016","6":"-1.22063736"},{"1":"42","2":"4","3":"-33.770023","4":"-2.543660677","5":"-14.5080591","6":"-15.05188945"},{"1":"43","2":"4","3":"-33.770023","4":"2.194035189","5":"-42.9342343","6":"-46.56700411"},{"1":"44","2":"4","3":"-33.770023","4":"1.942346285","5":"-41.4241009","6":"-42.36235125"},{"1":"45","2":"4","3":"-33.770023","4":"-3.008208938","5":"-11.7207695","6":"-9.50449589"},{"1":"46","2":"4","3":"-33.770023","4":"4.315463390","5":"-55.6628035","6":"-53.38186679"},{"1":"47","2":"4","3":"-33.770023","4":"4.748335910","5":"-58.2600386","6":"-54.80826009"},{"1":"48","2":"4","3":"-33.770023","4":"-3.498351695","5":"-8.7799130","6":"0.48027964"},{"1":"49","2":"4","3":"-33.770023","4":"-1.472624209","5":"-20.9342779","6":"-19.50160496"},{"1":"50","2":"4","3":"-33.770023","4":"3.084440490","5":"-48.2766661","6":"-52.04980359"},{"1":"1","2":"5","3":"-0.212874","4":"-0.310930460","5":"5.6527087","6":"10.99281456"},{"1":"2","2":"5","3":"-0.212874","4":"-2.787787290","5":"20.5138497","6":"18.49918142"},{"1":"3","2":"5","3":"-0.212874","4":"3.068576044","5":"-14.6243303","6":"-19.31437748"},{"1":"4","2":"5","3":"-0.212874","4":"4.314345287","5":"-22.0989457","6":"-17.11877296"},{"1":"5","2":"5","3":"-0.212874","4":"-2.739420598","5":"20.2236496","6":"26.44285077"},{"1":"6","2":"5","3":"-0.212874","4":"-1.359997960","5":"11.9471137","6":"16.15363674"},{"1":"7","2":"5","3":"-0.212874","4":"5.419416578","5":"-28.7293735","6":"-30.86512129"},{"1":"8","2":"5","3":"-0.212874","4":"3.253715306","5":"-15.7351659","6":"-11.63642801"},{"1":"9","2":"5","3":"-0.212874","4":"-0.447964322","5":"6.4749119","6":"4.14431208"},{"1":"10","2":"5","3":"-0.212874","4":"1.394505264","5":"-4.5799056","6":"-10.80104487"},{"1":"11","2":"5","3":"-0.212874","4":"0.059338010","5":"3.4310979","6":"4.37674112"},{"1":"12","2":"5","3":"-0.212874","4":"0.500143777","5":"0.7862633","6":"1.62733816"},{"1":"13","2":"5","3":"-0.212874","4":"-2.204908833","5":"17.0165790","6":"11.91654664"},{"1":"14","2":"5","3":"-0.212874","4":"3.321280276","5":"-16.1405557","6":"-8.92318232"},{"1":"15","2":"5","3":"-0.212874","4":"2.570184318","5":"-11.6339799","6":"-11.71238769"},{"1":"16","2":"5","3":"-0.212874","4":"-3.244713018","5":"23.2554041","6":"21.63725563"},{"1":"17","2":"5","3":"-0.212874","4":"-2.806951961","5":"20.6288377","6":"17.73087599"},{"1":"18","2":"5","3":"-0.212874","4":"2.060522549","5":"-8.5760093","6":"-16.73771434"},{"1":"19","2":"5","3":"-0.212874","4":"1.407754534","5":"-4.6594012","6":"-2.11827516"},{"1":"20","2":"5","3":"-0.212874","4":"3.968696191","5":"-20.0250512","6":"-20.41218494"},{"1":"21","2":"5","3":"-0.212874","4":"1.268187707","5":"-3.8220003","6":"-17.76531129"},{"1":"22","2":"5","3":"-0.212874","4":"2.683581648","5":"-12.3143639","6":"-10.20467688"},{"1":"23","2":"5","3":"-0.212874","4":"-3.781336131","5":"26.4751428","6":"25.75841305"},{"1":"24","2":"5","3":"-0.212874","4":"0.525512170","5":"0.6340530","6":"-4.60413775"},{"1":"25","2":"5","3":"-0.212874","4":"-2.599777780","5":"19.3857927","6":"12.28971116"},{"1":"26","2":"5","3":"-0.212874","4":"-1.224989724","5":"11.1370643","6":"15.88329955"},{"1":"27","2":"5","3":"-0.212874","4":"5.592647936","5":"-29.7687616","6":"-31.47853393"},{"1":"28","2":"5","3":"-0.212874","4":"0.954941718","5":"-1.9425243","6":"-9.82308894"},{"1":"29","2":"5","3":"-0.212874","4":"-1.052695140","5":"10.1032968","6":"10.08326321"},{"1":"30","2":"5","3":"-0.212874","4":"-3.709602446","5":"26.0447407","6":"22.73203769"},{"1":"31","2":"5","3":"-0.212874","4":"-4.451252091","5":"30.4946385","6":"32.31967203"},{"1":"32","2":"5","3":"-0.212874","4":"0.038963165","5":"3.5533470","6":"3.80948663"},{"1":"33","2":"5","3":"-0.212874","4":"-1.253731470","5":"11.3095148","6":"10.56696135"},{"1":"34","2":"5","3":"-0.212874","4":"-4.074501056","5":"28.2341323","6":"27.24309661"},{"1":"35","2":"5","3":"-0.212874","4":"-4.841136537","5":"32.8339452","6":"38.67928827"},{"1":"36","2":"5","3":"-0.212874","4":"-0.244897410","5":"5.2565104","6":"0.15423975"},{"1":"37","2":"5","3":"-0.212874","4":"-1.163277607","5":"10.7667916","6":"10.98355505"},{"1":"38","2":"5","3":"-0.212874","4":"0.140441548","5":"2.9444767","6":"6.82503813"},{"1":"39","2":"5","3":"-0.212874","4":"-3.087993473","5":"22.3150868","6":"26.27523012"},{"1":"40","2":"5","3":"-0.212874","4":"-4.455768648","5":"30.5217379","6":"32.95565863"},{"1":"41","2":"5","3":"-0.212874","4":"-0.520067399","5":"6.9075304","6":"9.90048745"},{"1":"42","2":"5","3":"-0.212874","4":"-3.655789099","5":"25.7218606","6":"28.49574000"},{"1":"43","2":"5","3":"-0.212874","4":"-0.164474468","5":"4.7739728","6":"2.18185488"},{"1":"44","2":"5","3":"-0.212874","4":"-2.485072084","5":"18.6975585","6":"24.58119059"},{"1":"45","2":"5","3":"-0.212874","4":"-0.434971438","5":"6.3969546","6":"0.39078495"},{"1":"46","2":"5","3":"-0.212874","4":"-3.442881786","5":"24.4444167","6":"16.45650917"},{"1":"47","2":"5","3":"-0.212874","4":"-4.293168350","5":"29.5461361","6":"25.35487348"},{"1":"48","2":"5","3":"-0.212874","4":"-1.793290504","5":"14.5468690","6":"9.04502030"},{"1":"49","2":"5","3":"-0.212874","4":"3.496576512","5":"-17.1923331","6":"-11.02193873"},{"1":"50","2":"5","3":"-0.212874","4":"1.733140602","5":"-6.6117176","6":"-0.57284294"},{"1":"1","2":"6","3":"8.024547","4":"5.762005963","5":"-22.5474892","6":"-26.90210350"},{"1":"2","2":"6","3":"8.024547","4":"3.572266265","5":"-9.4090510","6":"-14.36999099"},{"1":"3","2":"6","3":"8.024547","4":"1.080203882","5":"5.5433233","6":"9.73439475"},{"1":"4","2":"6","3":"8.024547","4":"-1.521186951","5":"21.1516683","6":"23.27635660"},{"1":"5","2":"6","3":"8.024547","4":"4.379125746","5":"-14.2502079","6":"-17.56484102"},{"1":"6","2":"6","3":"8.024547","4":"5.568918138","5":"-21.3889623","6":"-20.18062548"},{"1":"7","2":"6","3":"8.024547","4":"0.217375839","5":"10.7202915","6":"13.93741587"},{"1":"8","2":"6","3":"8.024547","4":"1.054724528","5":"5.6961994","6":"2.70572072"},{"1":"9","2":"6","3":"8.024547","4":"3.238360782","5":"-7.4056181","6":"-4.23552763"},{"1":"10","2":"6","3":"8.024547","4":"-3.166363658","5":"31.0227285","6":"31.92263303"},{"1":"11","2":"6","3":"8.024547","4":"1.109130768","5":"5.3697620","6":"5.97250302"},{"1":"12","2":"6","3":"8.024547","4":"4.875019621","5":"-17.2255712","6":"-13.04413872"},{"1":"13","2":"6","3":"8.024547","4":"-0.772758299","5":"16.6610964","6":"24.59688462"},{"1":"14","2":"6","3":"8.024547","4":"1.606861292","5":"2.3833788","6":"5.77074799"},{"1":"15","2":"6","3":"8.024547","4":"-1.637427692","5":"21.8491127","6":"25.08188854"},{"1":"16","2":"6","3":"8.024547","4":"0.360497634","5":"9.8615608","6":"16.35237856"},{"1":"17","2":"6","3":"8.024547","4":"-4.007841393","5":"36.0715949","6":"42.50511766"},{"1":"18","2":"6","3":"8.024547","4":"-3.763658468","5":"34.6064974","6":"28.01055673"},{"1":"19","2":"6","3":"8.024547","4":"4.054352120","5":"-12.3015661","6":"-12.97364250"},{"1":"20","2":"6","3":"8.024547","4":"4.857797974","5":"-17.1222413","6":"-23.38539446"},{"1":"21","2":"6","3":"8.024547","4":"4.665600889","5":"-15.9690588","6":"-17.73290510"},{"1":"22","2":"6","3":"8.024547","4":"1.830274382","5":"1.0429003","6":"-0.06798754"},{"1":"23","2":"6","3":"8.024547","4":"-0.019397952","5":"12.1409343","6":"5.63223495"},{"1":"24","2":"6","3":"8.024547","4":"-1.138794632","5":"18.8573144","6":"18.86158571"},{"1":"25","2":"6","3":"8.024547","4":"-1.111058701","5":"18.6908988","6":"18.27855007"},{"1":"26","2":"6","3":"8.024547","4":"0.178920978","5":"10.9510207","6":"4.19633886"},{"1":"27","2":"6","3":"8.024547","4":"3.725060914","5":"-10.3258189","6":"-7.18352170"},{"1":"28","2":"6","3":"8.024547","4":"4.402575456","5":"-14.3909062","6":"-12.97688682"},{"1":"29","2":"6","3":"8.024547","4":"3.586964065","5":"-9.4972378","6":"-8.19302025"},{"1":"30","2":"6","3":"8.024547","4":"5.327591201","5":"-19.9410006","6":"-24.57195403"},{"1":"31","2":"6","3":"8.024547","4":"0.501063515","5":"9.0181655","6":"14.87557008"},{"1":"32","2":"6","3":"8.024547","4":"-2.910373573","5":"29.4867880","6":"33.42229259"},{"1":"33","2":"6","3":"8.024547","4":"-4.526431381","5":"39.1831349","6":"38.90987325"},{"1":"34","2":"6","3":"8.024547","4":"2.358986088","5":"-2.1293700","6":"0.21469491"},{"1":"35","2":"6","3":"8.024547","4":"2.460179142","5":"-2.7365283","6":"-6.50990473"},{"1":"36","2":"6","3":"8.024547","4":"-4.673721521","5":"40.0668757","6":"42.98525588"},{"1":"37","2":"6","3":"8.024547","4":"2.871335299","5":"-5.2034652","6":"-2.13813615"},{"1":"38","2":"6","3":"8.024547","4":"5.468050015","5":"-20.7837535","6":"-22.97766557"},{"1":"39","2":"6","3":"8.024547","4":"-2.410795298","5":"26.4893184","6":"19.19122120"},{"1":"40","2":"6","3":"8.024547","4":"1.062859385","5":"5.6473903","6":"1.42819902"},{"1":"41","2":"6","3":"8.024547","4":"-2.001000339","5":"24.0305486","6":"29.50669957"},{"1":"42","2":"6","3":"8.024547","4":"-3.485185081","5":"32.9356571","6":"36.56372532"},{"1":"43","2":"6","3":"8.024547","4":"5.213400481","5":"-19.2558563","6":"-12.90898874"},{"1":"44","2":"6","3":"8.024547","4":"-1.977834862","5":"23.8915557","6":"25.14710679"},{"1":"45","2":"6","3":"8.024547","4":"1.555857464","5":"2.6894018","6":"8.62160854"},{"1":"46","2":"6","3":"8.024547","4":"-4.478812069","5":"38.8974190","6":"50.51964602"},{"1":"47","2":"6","3":"8.024547","4":"2.777629842","5":"-4.6412325","6":"-5.09786894"},{"1":"48","2":"6","3":"8.024547","4":"5.647443172","5":"-21.8601125","6":"-16.07921622"},{"1":"49","2":"6","3":"8.024547","4":"1.501049282","5":"3.0182509","6":"3.88743979"},{"1":"50","2":"6","3":"8.024547","4":"5.704438214","5":"-22.2020827","6":"-22.24129331"},{"1":"1","2":"7","3":"-44.453710","4":"3.191068095","5":"-59.6001188","6":"-60.88677127"},{"1":"2","2":"7","3":"-44.453710","4":"-1.950002683","5":"-28.7536941","6":"-27.32134782"},{"1":"3","2":"7","3":"-44.453710","4":"-4.455335903","5":"-13.7216948","6":"-13.62128415"},{"1":"4","2":"7","3":"-44.453710","4":"5.727343795","5":"-74.8177730","6":"-68.58155355"},{"1":"5","2":"7","3":"-44.453710","4":"-4.696841446","5":"-12.2726615","6":"-9.79029368"},{"1":"6","2":"7","3":"-44.453710","4":"-2.905052319","5":"-23.0233963","6":"-22.06247731"},{"1":"7","2":"7","3":"-44.453710","4":"0.751945803","5":"-44.9653850","6":"-40.37443676"},{"1":"8","2":"7","3":"-44.453710","4":"4.845973601","5":"-69.5295518","6":"-76.70819719"},{"1":"9","2":"7","3":"-44.453710","4":"-0.279130270","5":"-38.7789286","6":"-39.88738838"},{"1":"10","2":"7","3":"-44.453710","4":"5.600002187","5":"-74.0537233","6":"-76.56506359"},{"1":"11","2":"7","3":"-44.453710","4":"0.628571369","5":"-44.2251384","6":"-43.13202673"},{"1":"12","2":"7","3":"-44.453710","4":"2.459933769","5":"-55.2133128","6":"-47.25872010"},{"1":"13","2":"7","3":"-44.453710","4":"5.829567412","5":"-75.4311147","6":"-77.25387238"},{"1":"14","2":"7","3":"-44.453710","4":"3.381929134","5":"-60.7452850","6":"-59.65142749"},{"1":"15","2":"7","3":"-44.453710","4":"-2.365828221","5":"-26.2587409","6":"-28.30786390"},{"1":"16","2":"7","3":"-44.453710","4":"-4.571006117","5":"-13.0276735","6":"-18.24460594"},{"1":"17","2":"7","3":"-44.453710","4":"-3.013630322","5":"-22.3719283","6":"-29.10553075"},{"1":"18","2":"7","3":"-44.453710","4":"-0.005833517","5":"-40.4187091","6":"-40.56910806"},{"1":"19","2":"7","3":"-44.453710","4":"-1.139293460","5":"-33.6179495","6":"-33.57949022"},{"1":"20","2":"7","3":"-44.453710","4":"-3.119549675","5":"-21.7364122","6":"-23.74785736"},{"1":"21","2":"7","3":"-44.453710","4":"3.779646583","5":"-63.1315897","6":"-63.62283141"},{"1":"22","2":"7","3":"-44.453710","4":"-0.263385209","5":"-38.8733990","6":"-43.40809888"},{"1":"23","2":"7","3":"-44.453710","4":"4.235684132","5":"-65.8678150","6":"-67.53584552"},{"1":"24","2":"7","3":"-44.453710","4":"1.967413269","5":"-52.2581898","6":"-49.96756009"},{"1":"25","2":"7","3":"-44.453710","4":"5.074593731","5":"-70.9012726","6":"-71.79979933"},{"1":"26","2":"7","3":"-44.453710","4":"5.688857227","5":"-74.5868536","6":"-74.92310126"},{"1":"27","2":"7","3":"-44.453710","4":"-4.373654094","5":"-14.2117857","6":"-12.64187589"},{"1":"28","2":"7","3":"-44.453710","4":"-4.912320381","5":"-10.9797879","6":"-13.42939751"},{"1":"29","2":"7","3":"-44.453710","4":"0.302398770","5":"-42.2681028","6":"-44.03034137"},{"1":"30","2":"7","3":"-44.453710","4":"5.549252390","5":"-73.7492246","6":"-81.17071162"},{"1":"31","2":"7","3":"-44.453710","4":"1.378690673","5":"-48.7258543","6":"-46.01547474"},{"1":"32","2":"7","3":"-44.453710","4":"-1.584218768","5":"-30.9483976","6":"-40.21172673"},{"1":"33","2":"7","3":"-44.453710","4":"0.131368187","5":"-41.2419193","6":"-37.16547925"},{"1":"34","2":"7","3":"-44.453710","4":"1.254375884","5":"-47.9799655","6":"-49.99414964"},{"1":"35","2":"7","3":"-44.453710","4":"-2.493661885","5":"-25.4917389","6":"-21.19739247"},{"1":"36","2":"7","3":"-44.453710","4":"3.494709408","5":"-61.4219667","6":"-67.52541931"},{"1":"37","2":"7","3":"-44.453710","4":"0.088603216","5":"-40.9853295","6":"-39.13795672"},{"1":"38","2":"7","3":"-44.453710","4":"3.270619912","5":"-60.0774297","6":"-59.23876729"},{"1":"39","2":"7","3":"-44.453710","4":"0.054587943","5":"-40.7812379","6":"-36.43783010"},{"1":"40","2":"7","3":"-44.453710","4":"-0.577691188","5":"-36.9875631","6":"-38.46003661"},{"1":"41","2":"7","3":"-44.453710","4":"2.099921781","5":"-53.0532409","6":"-53.37511124"},{"1":"42","2":"7","3":"-44.453710","4":"-2.934069552","5":"-22.8492929","6":"-26.32128428"},{"1":"43","2":"7","3":"-44.453710","4":"4.078704456","5":"-64.9259370","6":"-66.55292487"},{"1":"44","2":"7","3":"-44.453710","4":"2.125418018","5":"-53.2062183","6":"-57.10763302"},{"1":"45","2":"7","3":"-44.453710","4":"3.937531338","5":"-64.0788982","6":"-65.58443436"},{"1":"46","2":"7","3":"-44.453710","4":"0.383350361","5":"-42.7538124","6":"-44.15601378"},{"1":"47","2":"7","3":"-44.453710","4":"-3.738134363","5":"-18.0249040","6":"-16.43693152"},{"1":"48","2":"7","3":"-44.453710","4":"-0.245863824","5":"-38.9785273","6":"-37.28184016"},{"1":"49","2":"7","3":"-44.453710","4":"-3.761407634","5":"-17.8852644","6":"-21.89688567"},{"1":"50","2":"7","3":"-44.453710","4":"-1.752666585","5":"-29.9377107","6":"-29.61002822"},{"1":"1","2":"8","3":"22.737596","4":"-3.294982330","5":"46.5074899","6":"49.45743402"},{"1":"2","2":"8","3":"22.737596","4":"-3.038599321","5":"44.9691918","6":"48.06847248"},{"1":"3","2":"8","3":"22.737596","4":"1.388477521","5":"18.4067308","6":"15.63585019"},{"1":"4","2":"8","3":"22.737596","4":"1.421121159","5":"18.2108689","6":"16.84995616"},{"1":"5","2":"8","3":"22.737596","4":"5.425585189","5":"-5.8159153","6":"-5.28693583"},{"1":"6","2":"8","3":"22.737596","4":"-1.036654555","5":"32.9575232","6":"29.22105282"},{"1":"7","2":"8","3":"22.737596","4":"1.182151255","5":"19.6446883","6":"20.90588125"},{"1":"8","2":"8","3":"22.737596","4":"3.160319583","5":"7.7756784","6":"6.21545331"},{"1":"9","2":"8","3":"22.737596","4":"0.298111391","5":"24.9489275","6":"25.02065979"},{"1":"10","2":"8","3":"22.737596","4":"-0.053552444","5":"27.0589105","6":"28.48727332"},{"1":"11","2":"8","3":"22.737596","4":"-2.537574972","5":"41.9630457","6":"42.84527652"},{"1":"12","2":"8","3":"22.737596","4":"-3.215951346","5":"46.0333040","6":"49.10834592"},{"1":"13","2":"8","3":"22.737596","4":"1.883734968","5":"15.4351861","6":"19.36503465"},{"1":"14","2":"8","3":"22.737596","4":"-0.737711361","5":"31.1638640","6":"32.69786010"},{"1":"15","2":"8","3":"22.737596","4":"4.499437722","5":"-0.2590305","6":"0.47517477"},{"1":"16","2":"8","3":"22.737596","4":"-0.520705171","5":"29.8618269","6":"33.22707031"},{"1":"17","2":"8","3":"22.737596","4":"-4.687359471","5":"54.8617527","6":"54.64591684"},{"1":"18","2":"8","3":"22.737596","4":"-1.058392439","5":"33.0879505","6":"42.89090495"},{"1":"19","2":"8","3":"22.737596","4":"5.982185045","5":"-9.1555144","6":"-8.28611327"},{"1":"20","2":"8","3":"22.737596","4":"-1.658732690","5":"36.6899920","6":"38.26262532"},{"1":"21","2":"8","3":"22.737596","4":"-3.253898997","5":"46.2609899","6":"51.55579790"},{"1":"22","2":"8","3":"22.737596","4":"-4.627355951","5":"54.5017316","6":"57.71244635"},{"1":"23","2":"8","3":"22.737596","4":"2.522114743","5":"11.6049074","6":"13.45427107"},{"1":"24","2":"8","3":"22.737596","4":"1.758379909","5":"16.1873164","6":"19.04311905"},{"1":"25","2":"8","3":"22.737596","4":"5.728151076","5":"-7.6313106","6":"-10.28428516"},{"1":"26","2":"8","3":"22.737596","4":"-0.227505430","5":"28.1026285","6":"27.11151496"},{"1":"27","2":"8","3":"22.737596","4":"-2.837986640","5":"43.7655157","6":"46.84517413"},{"1":"28","2":"8","3":"22.737596","4":"-1.201691797","5":"33.9477467","6":"28.98356901"},{"1":"29","2":"8","3":"22.737596","4":"-4.906316676","5":"56.1754959","6":"60.20824900"},{"1":"30","2":"8","3":"22.737596","4":"1.069139475","5":"20.3227590","6":"26.37377199"},{"1":"31","2":"8","3":"22.737596","4":"0.487015148","5":"23.8155050","6":"25.82499357"},{"1":"32","2":"8","3":"22.737596","4":"5.439742218","5":"-5.9008574","6":"-4.92739629"},{"1":"33","2":"8","3":"22.737596","4":"-0.094798483","5":"27.3063868","6":"27.31865813"},{"1":"34","2":"8","3":"22.737596","4":"-3.038836339","5":"44.9706139","6":"44.19593036"},{"1":"35","2":"8","3":"22.737596","4":"-2.999228931","5":"44.7329695","6":"46.16282114"},{"1":"36","2":"8","3":"22.737596","4":"-4.274577420","5":"52.3850604","6":"50.39952842"},{"1":"37","2":"8","3":"22.737596","4":"-0.519984680","5":"29.8575040","6":"24.68475442"},{"1":"38","2":"8","3":"22.737596","4":"-0.169872854","5":"27.7568330","6":"27.28078103"},{"1":"39","2":"8","3":"22.737596","4":"2.812573771","5":"9.8621533","6":"1.43880742"},{"1":"40","2":"8","3":"22.737596","4":"5.858914073","5":"-8.4158886","6":"-7.97082831"},{"1":"41","2":"8","3":"22.737596","4":"2.873146222","5":"9.4987185","6":"9.72370706"},{"1":"42","2":"8","3":"22.737596","4":"-4.931472313","5":"56.3264298","6":"58.90221074"},{"1":"43","2":"8","3":"22.737596","4":"3.865076511","5":"3.5471368","6":"10.31776393"},{"1":"44","2":"8","3":"22.737596","4":"1.710624650","5":"16.4738480","6":"16.13453594"},{"1":"45","2":"8","3":"22.737596","4":"5.886643399","5":"-8.5822645","6":"-9.12137758"},{"1":"46","2":"8","3":"22.737596","4":"-0.487279674","5":"29.6612739","6":"34.88188740"},{"1":"47","2":"8","3":"22.737596","4":"2.038804224","5":"14.5047705","6":"10.85478208"},{"1":"48","2":"8","3":"22.737596","4":"0.588653530","5":"23.2056747","6":"17.53240282"},{"1":"49","2":"8","3":"22.737596","4":"-3.099554935","5":"45.3349255","6":"51.30573389"},{"1":"50","2":"8","3":"22.737596","4":"3.262279976","5":"7.1639160","6":"8.77881886"},{"1":"1","2":"9","3":"-22.985108","4":"4.999727737","5":"-48.9834748","6":"-52.78310512"},{"1":"2","2":"9","3":"-22.985108","4":"-4.451142710","5":"7.7217479","6":"4.81872913"},{"1":"3","2":"9","3":"-22.985108","4":"-1.620275600","5":"-9.2634548","6":"-11.21448713"},{"1":"4","2":"9","3":"-22.985108","4":"4.064975855","5":"-43.3749635","6":"-42.30926758"},{"1":"5","2":"9","3":"-22.985108","4":"-3.674545934","5":"3.0621672","6":"2.66813238"},{"1":"6","2":"9","3":"-22.985108","4":"-4.354511469","5":"7.1419604","6":"10.66318929"},{"1":"7","2":"9","3":"-22.985108","4":"4.827862628","5":"-47.9522842","6":"-45.26303512"},{"1":"8","2":"9","3":"-22.985108","4":"5.251127997","5":"-50.4918764","6":"-43.76299941"},{"1":"9","2":"9","3":"-22.985108","4":"5.340035043","5":"-51.0253187","6":"-54.43886321"},{"1":"10","2":"9","3":"-22.985108","4":"-1.635722118","5":"-9.1707757","6":"-6.82228429"},{"1":"11","2":"9","3":"-22.985108","4":"4.388670484","5":"-45.3171313","6":"-46.82242006"},{"1":"12","2":"9","3":"-22.985108","4":"1.890360824","5":"-30.3272733","6":"-32.43872770"},{"1":"13","2":"9","3":"-22.985108","4":"-1.736381677","5":"-8.5668183","6":"-4.32386830"},{"1":"14","2":"9","3":"-22.985108","4":"2.926694669","5":"-36.5452764","6":"-33.55402173"},{"1":"15","2":"9","3":"-22.985108","4":"4.319683473","5":"-44.9032092","6":"-41.88731580"},{"1":"16","2":"9","3":"-22.985108","4":"-2.268302093","5":"-5.3752958","6":"-13.15821868"},{"1":"17","2":"9","3":"-22.985108","4":"-1.919290685","5":"-7.4693643","6":"-2.38481075"},{"1":"18","2":"9","3":"-22.985108","4":"2.711213587","5":"-35.2523899","6":"-30.58796069"},{"1":"19","2":"9","3":"-22.985108","4":"-4.340669573","5":"7.0589090","6":"2.98916306"},{"1":"20","2":"9","3":"-22.985108","4":"-1.581637226","5":"-9.4952850","6":"-3.51772881"},{"1":"21","2":"9","3":"-22.985108","4":"1.527873438","5":"-28.1523490","6":"-28.19732940"},{"1":"22","2":"9","3":"-22.985108","4":"3.429255424","5":"-39.5606409","6":"-41.03352375"},{"1":"23","2":"9","3":"-22.985108","4":"1.415981218","5":"-27.4809957","6":"-30.37412535"},{"1":"24","2":"9","3":"-22.985108","4":"-0.305409068","5":"-17.1526540","6":"-12.53403718"},{"1":"25","2":"9","3":"-22.985108","4":"-3.887314871","5":"4.3387808","6":"8.85839681"},{"1":"26","2":"9","3":"-22.985108","4":"-0.545980464","5":"-15.7092256","6":"-14.44873287"},{"1":"27","2":"9","3":"-22.985108","4":"5.608523743","5":"-52.6362509","6":"-48.71896160"},{"1":"28","2":"9","3":"-22.985108","4":"4.658170836","5":"-46.9341334","6":"-49.50144285"},{"1":"29","2":"9","3":"-22.985108","4":"0.413984972","5":"-21.4690182","6":"-18.27939107"},{"1":"30","2":"9","3":"-22.985108","4":"4.920070562","5":"-48.5055318","6":"-49.06561806"},{"1":"31","2":"9","3":"-22.985108","4":"-1.228002177","5":"-11.6170953","6":"-12.63407924"},{"1":"32","2":"9","3":"-22.985108","4":"5.060697705","5":"-49.3492946","6":"-45.55751712"},{"1":"33","2":"9","3":"-22.985108","4":"-2.421794165","5":"-4.4543434","6":"-2.74077160"},{"1":"34","2":"9","3":"-22.985108","4":"-3.656095782","5":"2.9514663","6":"2.76221302"},{"1":"35","2":"9","3":"-22.985108","4":"-4.772806631","5":"9.6517314","6":"4.97215485"},{"1":"36","2":"9","3":"-22.985108","4":"0.567164498","5":"-22.3880954","6":"-21.02975288"},{"1":"37","2":"9","3":"-22.985108","4":"3.111153467","5":"-37.6520292","6":"-37.61921927"},{"1":"38","2":"9","3":"-22.985108","4":"-1.362652709","5":"-10.8091921","6":"-10.73438087"},{"1":"39","2":"9","3":"-22.985108","4":"0.075941090","5":"-19.4407549","6":"-22.99604398"},{"1":"40","2":"9","3":"-22.985108","4":"-1.163775438","5":"-12.0024558","6":"-9.43757347"},{"1":"41","2":"9","3":"-22.985108","4":"-4.997301624","5":"10.9987013","6":"11.12117902"},{"1":"42","2":"9","3":"-22.985108","4":"3.093397731","5":"-37.5454948","6":"-31.26472602"},{"1":"43","2":"9","3":"-22.985108","4":"2.711545923","5":"-35.2543839","6":"-32.06726597"},{"1":"44","2":"9","3":"-22.985108","4":"3.236403638","5":"-38.4035302","6":"-38.05515586"},{"1":"45","2":"9","3":"-22.985108","4":"-0.282130488","5":"-17.2923255","6":"-17.08191494"},{"1":"46","2":"9","3":"-22.985108","4":"3.360645686","5":"-39.1489825","6":"-40.38783699"},{"1":"47","2":"9","3":"-22.985108","4":"-3.953081068","5":"4.7333780","6":"7.08366102"},{"1":"48","2":"9","3":"-22.985108","4":"-1.131341759","5":"-12.1970578","6":"-17.88832223"},{"1":"49","2":"9","3":"-22.985108","4":"-4.581671174","5":"8.5049186","6":"9.57068744"},{"1":"50","2":"9","3":"-22.985108","4":"0.011720947","5":"-19.0554341","6":"-22.49744552"},{"1":"1","2":"10","3":"-3.942871","4":"4.705290623","5":"-28.1746145","6":"-32.11531349"},{"1":"2","2":"10","3":"-3.942871","4":"3.971129525","5":"-23.7696479","6":"-24.08150372"},{"1":"3","2":"10","3":"-3.942871","4":"-1.320188431","5":"7.9782598","6":"7.63580472"},{"1":"4","2":"10","3":"-3.942871","4":"-4.188807075","5":"25.1899717","6":"22.85547514"},{"1":"5","2":"10","3":"-3.942871","4":"-4.731477880","5":"28.4459965","6":"32.26348006"},{"1":"6","2":"10","3":"-3.942871","4":"-4.078965241","5":"24.5309207","6":"22.56324578"},{"1":"7","2":"10","3":"-3.942871","4":"0.478021369","5":"-2.8109990","6":"-2.22091540"},{"1":"8","2":"10","3":"-3.942871","4":"1.835755663","5":"-10.9574048","6":"-15.44252412"},{"1":"9","2":"10","3":"-3.942871","4":"-2.758359579","5":"16.6072867","6":"20.08180228"},{"1":"10","2":"10","3":"-3.942871","4":"-0.146979208","5":"0.9390045","6":"2.66833555"},{"1":"11","2":"10","3":"-3.942871","4":"2.434876941","5":"-14.5521324","6":"-18.67049764"},{"1":"12","2":"10","3":"-3.942871","4":"-3.540024627","5":"21.2972770","6":"22.05908889"},{"1":"13","2":"10","3":"-3.942871","4":"0.780816592","5":"-4.6277703","6":"-1.72154567"},{"1":"14","2":"10","3":"-3.942871","4":"2.191210408","5":"-13.0901332","6":"-21.58165412"},{"1":"15","2":"10","3":"-3.942871","4":"-0.309993957","5":"1.9170930","6":"4.22458804"},{"1":"16","2":"10","3":"-3.942871","4":"-3.763771435","5":"22.6397578","6":"14.92839999"},{"1":"17","2":"10","3":"-3.942871","4":"-0.576234808","5":"3.5145381","6":"-0.80617090"},{"1":"18","2":"10","3":"-3.942871","4":"-0.431064884","5":"2.6435185","6":"2.96580438"},{"1":"19","2":"10","3":"-3.942871","4":"5.208421707","5":"-31.1934010","6":"-34.04996355"},{"1":"20","2":"10","3":"-3.942871","4":"1.216685714","5":"-7.2429851","6":"-7.75327872"},{"1":"21","2":"10","3":"-3.942871","4":"-3.888403880","5":"23.3875525","6":"26.79026188"},{"1":"22","2":"10","3":"-3.942871","4":"-1.498620659","5":"9.0488532","6":"3.51323829"},{"1":"23","2":"10","3":"-3.942871","4":"0.737692891","5":"-4.3690281","6":"-0.24658089"},{"1":"24","2":"10","3":"-3.942871","4":"3.227968889","5":"-19.3106841","6":"-24.54013266"},{"1":"25","2":"10","3":"-3.942871","4":"4.174129030","5":"-24.9876450","6":"-26.40602105"},{"1":"26","2":"10","3":"-3.942871","4":"4.885685973","5":"-29.2569866","6":"-27.44273902"},{"1":"27","2":"10","3":"-3.942871","4":"4.228138579","5":"-25.3117022","6":"-25.68018689"},{"1":"28","2":"10","3":"-3.942871","4":"5.821240105","5":"-34.8703114","6":"-40.23792873"},{"1":"29","2":"10","3":"-3.942871","4":"3.014220314","5":"-18.0281927","6":"-16.93548451"},{"1":"30","2":"10","3":"-3.942871","4":"-0.578564564","5":"3.5285166","6":"5.99107326"},{"1":"31","2":"10","3":"-3.942871","4":"3.501262807","5":"-20.9504476","6":"-22.04722381"},{"1":"32","2":"10","3":"-3.942871","4":"-0.077309034","5":"0.5209834","6":"0.89041778"},{"1":"33","2":"10","3":"-3.942871","4":"3.315918918","5":"-19.8383843","6":"-16.60236223"},{"1":"34","2":"10","3":"-3.942871","4":"0.618313262","5":"-3.6527503","6":"-5.06187476"},{"1":"35","2":"10","3":"-3.942871","4":"-2.156687575","5":"12.9972547","6":"9.12652604"},{"1":"36","2":"10","3":"-3.942871","4":"-2.103974229","5":"12.6809746","6":"12.39499601"},{"1":"37","2":"10","3":"-3.942871","4":"5.222762026","5":"-31.2794429","6":"-23.94315275"},{"1":"38","2":"10","3":"-3.942871","4":"-1.312966962","5":"7.9349310","6":"7.16468185"},{"1":"39","2":"10","3":"-3.942871","4":"-4.267315659","5":"25.6610232","6":"23.89280829"},{"1":"40","2":"10","3":"-3.942871","4":"-3.751854318","5":"22.5682551","6":"23.22756400"},{"1":"41","2":"10","3":"-3.942871","4":"-4.747947654","5":"28.5448151","6":"33.96065886"},{"1":"42","2":"10","3":"-3.942871","4":"0.614756098","5":"-3.6314074","6":"5.34332104"},{"1":"43","2":"10","3":"-3.942871","4":"-3.379020509","5":"20.3312523","6":"23.22922616"},{"1":"44","2":"10","3":"-3.942871","4":"2.081407318","5":"-12.4313147","6":"-18.11094778"},{"1":"45","2":"10","3":"-3.942871","4":"-4.070564890","5":"24.4805186","6":"22.39073113"},{"1":"46","2":"10","3":"-3.942871","4":"0.117903442","5":"-0.6502914","6":"-0.03155762"},{"1":"47","2":"10","3":"-3.942871","4":"5.323894942","5":"-31.8862404","6":"-32.75227297"},{"1":"48","2":"10","3":"-3.942871","4":"-3.295391388","5":"19.8294776","6":"27.91167165"},{"1":"49","2":"10","3":"-3.942871","4":"5.278866282","5":"-31.6160685","6":"-27.59556486"},{"1":"50","2":"10","3":"-3.942871","4":"-2.410053665","5":"14.5174512","6":"13.81773570"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[6],"max":[6]},"pages":{}}}
  </script>
</div>
<p>El siguiente paso es dibujar los datos para explorar si sería apropiado usar un modelo con intercepto aleatorio (obvio porque así se simularon los datos). El código para dibujar los datos se muestra abajo.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="pac-lme4.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb17-2"><a href="pac-lme4.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(x, y, <span class="at">color=</span>grupo) ) <span class="sc">+</span> </span>
<span id="cb17-3"><a href="pac-lme4.html#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb17-4"><a href="pac-lme4.html#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">colour=</span><span class="st">&quot;Grupo/Cluster&quot;</span>)</span></code></pre></div>
<p><img src="libro_mod_mixtos_files/figure-html/plot_simul_b0_lme4-1.png" width="672" /></p>
<p>En la figura anterior se observa un patrón claro, todas las 10 nubes de puntos tienen la misma pendiente pero diferente intercepto con el eje vertical, eso se debe a que en la simulación se incluyó un <span class="math inline">\(b_0\)</span>.</p>
<p>Para estimar los parámetros del modelos se usa la función <code>mler</code> de la siguiente forma.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="pac-lme4.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb18-2"><a href="pac-lme4.html#cb18-2" aria-hidden="true" tabindex="-1"></a>fit1 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(y <span class="sc">~</span> x <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> grupo), <span class="at">data =</span> datos)</span></code></pre></div>
<p>La función <code>summary</code> se puede usar sobre el objeto <code>fit1</code> para obtener una tabla de resumen, a continuación se ilustra el uso y la salida de <code>summary</code>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="pac-lme4.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span></code></pre></div>
<p><img src="images/summary_fit_lmer.png" width="110%" style="display: block; margin: auto;" /></p>
<p>Según el resultado anterior <span class="math inline">\(\hat{\boldsymbol{\Theta}}=(\hat{\beta}_0=2.2378, \hat{\beta}_1=-6.0264, \hat{\sigma}_y=3.9352, \hat{\sigma}_{b0}=25.369)^\top\)</span> mientras que el vector real de parámetros es <span class="math inline">\(\boldsymbol{\Theta}=(\beta_0=4, \beta_1=-6, \sigma_y=4, \sigma_{b0}=25)^\top\)</span>.</p>
<div style="-moz-box-shadow: 1px 1px 3px 2px #00ffff;
  -webkit-box-shadow: 1px 1px 3px 2px #00ffff;
  box-shadow:         1px 1px 3px 2px #00ffff;">

<div class="rmdtip">
<p>Compare los resultados de la tabla anterior obtenida con la función <code>lmer</code> anterior con los resultados obtenidos con la función <code>lme</code> de capítulo <a href="pac-nlme.html#pac-nlme">6</a>.</p>
¿Hay alguna similitud?
</div>
</div>
</div>
<div id="ejemplo-recuperando-los-interceptos-aleatorios" class="section level2 unnumbered">
<h2>Ejemplo: recuperando los interceptos aleatorios</h2>
<p>¿Cómo se pueden obtener los interceptos aleatorios a partir del modelo ajustado en la sección anterior?</p>
<div style="-moz-box-shadow: 1px 1px 3px 2px #000000;
  -webkit-box-shadow: 1px 1px 3px 2px #000000;
  box-shadow:         1px 1px 3px 2px #000000;">

<div class="rmdexercise">
Solución.
</div>
</div>
<p>Para obtener los interceptos aleatorios se usa la función <code>ranef</code> del paquete <strong>lme4</strong> de <span class="citation">Bates et al. (<a href="#ref-R-lme4" role="doc-biblioref">2021</a>)</span>. A continuación vamos a obtener los interceptos aleatorios y los vamos a comparar con los <span class="math inline">\(b_0\)</span> simulados.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="pac-lme4.html#cb20-1" aria-hidden="true" tabindex="-1"></a>interceptos_aleatorios <span class="ot">&lt;-</span> <span class="fu">ranef</span>(fit1)</span>
<span id="cb20-2"><a href="pac-lme4.html#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(interceptos_aleatorios<span class="sc">$</span>grupo, <span class="at">b0=</span><span class="fu">unique</span>(b0))</span></code></pre></div>
<pre><code>##    (Intercept)         b0
## 1     5.388795   3.917594
## 2    35.790443  34.345280
## 3    19.885504  18.266756
## 4   -31.893039 -33.770023
## 5     1.074942  -0.212874
## 6    10.680482   8.024547
## 7   -43.320003 -44.453710
## 8    25.363102  22.737596
## 9   -20.648195 -22.985108
## 10   -2.322031  -3.942871</code></pre>
<p>De la salida anterior vemos que los <span class="math inline">\(\tilde{b}_0\)</span> son cercanos a los valores reales de <span class="math inline">\(b_0\)</span>.</p>
<div style="-moz-box-shadow: 1px 1px 3px 2px #808080;
  -webkit-box-shadow: 1px 1px 3px 2px #808080;
  box-shadow:         1px 1px 3px 2px #808080;">

<div class="rmdwarning">
La comparación anterior solo es posible cuando usamos datos simulados. Cuando se usan datos de un fenómeno real no se tienen los valores de <span class="math inline">\(b_0\)</span>.
</div>
</div>
</div>
<div id="función-glmer" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Función <code>glmer</code></h2>
<p>La función <code>glmer</code> es la función del paquete <strong>lme4</strong> para ajustar modelo lineales generalizados mixtos y su estructura es la siguiente:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="pac-lme4.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lmer</span>(formula, <span class="at">data =</span> <span class="cn">NULL</span>, <span class="at">family =</span> gaussian,</span>
<span id="cb22-2"><a href="pac-lme4.html#cb22-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">control =</span> <span class="fu">glmerControl</span>(),</span>
<span id="cb22-3"><a href="pac-lme4.html#cb22-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">start =</span> <span class="cn">NULL</span>, <span class="at">verbose =</span> 0L, <span class="at">nAGQ =</span> 1L,</span>
<span id="cb22-4"><a href="pac-lme4.html#cb22-4" aria-hidden="true" tabindex="-1"></a>     subset, weights, na.action, offset, <span class="at">contrasts =</span> <span class="cn">NULL</span>,</span>
<span id="cb22-5"><a href="pac-lme4.html#cb22-5" aria-hidden="true" tabindex="-1"></a>     mustart, etastart, <span class="at">devFunOnly =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>Los principales argumentos de la función son:</p>
<ul>
<li><code>formula</code>: es una fórmula similar a la usada en el modelo lineal clásico. Un ejemplo de fórmula sería <code>y ~ 1 + x1 + x2 + (1 + x2)</code> con la cual se indican los efectos fijos y los efectos aleatorios del modelo. Más abajo hay una tabla con más detalles sobre la fórmula.</li>
<li><code>data</code>: marco de datos donde están las variables.<br />
</li>
<li><code>family</code>: argumento para seleccionar la distribución de la variable respuesta. Para más detalles de las distribuciones y funciones de enlace se recomienda ver la ayuda de la función <code>family</code> escribiendo esto en la consola <code>?family</code>.</li>
</ul>
</div>
<div id="ejemplo-modelo-gamma-con-intercepto-aleatorio" class="section level2 unnumbered">
<h2>Ejemplo: modelo gamma con intercepto aleatorio</h2>
<p>En este ejemplo vamos a simular observaciones <span class="math inline">\(n_i=20\)</span> observaciones para <span class="math inline">\(G=10\)</span> grupos (en total 200 obs) que tengan la estructura mostrada abajo. El objetivo del ejemplo es ilustrar el uso de la función <code>glmer</code> para estimar los parámetros del modelo.</p>
<p><span class="math display">\[\begin{align*} 
y_{ij} &amp;\sim  Gamma(\mu_{ij}, \phi) \\ 
\log(\mu_{ij}) &amp;= 2 - 8 x_{ij} + b_{0i} \\
\phi &amp;= 0.5 \\
b_{0} &amp;\sim N(0, \sigma^2_{b0}=9) \\
x_{ij} &amp;\sim U(0, 1)
\end{align*}\]</span></p>
<p>El vector de parámetros de este modelo es <span class="math inline">\(\boldsymbol{\Theta}=(\beta_0=2, \beta_1=-8, \phi=0.5, \sigma_{b0}=3)^\top\)</span>.</p>
<div style="-moz-box-shadow: 1px 1px 3px 2px #000000;
  -webkit-box-shadow: 1px 1px 3px 2px #000000;
  box-shadow:         1px 1px 3px 2px #000000;">

<div class="rmdexercise">
Solución.
</div>
</div>
<p>La función <code>rgamma_glm</code> que se muestra a continuación es una modificación de la función <code>rgamma</code> para tener la parametrización usada en los glm.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="pac-lme4.html#cb23-1" aria-hidden="true" tabindex="-1"></a>rgamma_glm <span class="ot">&lt;-</span> <span class="cf">function</span>(n, mu, phi) {</span>
<span id="cb23-2"><a href="pac-lme4.html#cb23-2" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(<span class="at">n=</span>n, <span class="at">shape=</span><span class="dv">1</span><span class="sc">/</span>phi, <span class="at">scale=</span>mu<span class="sc">*</span>phi)</span>
<span id="cb23-3"><a href="pac-lme4.html#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb23-4"><a href="pac-lme4.html#cb23-4" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>A continuación el código para simular datos del modelo de interés.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="pac-lme4.html#cb24-1" aria-hidden="true" tabindex="-1"></a>ni <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb24-2"><a href="pac-lme4.html#cb24-2" aria-hidden="true" tabindex="-1"></a>G <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb24-3"><a href="pac-lme4.html#cb24-3" aria-hidden="true" tabindex="-1"></a>nobs <span class="ot">&lt;-</span> ni <span class="sc">*</span> G</span>
<span id="cb24-4"><a href="pac-lme4.html#cb24-4" aria-hidden="true" tabindex="-1"></a>grupo <span class="ot">&lt;-</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span>G, <span class="at">each=</span>ni))</span>
<span id="cb24-5"><a href="pac-lme4.html#cb24-5" aria-hidden="true" tabindex="-1"></a>obs <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="at">x=</span><span class="dv">1</span><span class="sc">:</span>ni, <span class="at">times=</span>G)</span>
<span id="cb24-6"><a href="pac-lme4.html#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb24-7"><a href="pac-lme4.html#cb24-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n=</span>nobs, <span class="at">min=</span><span class="dv">0</span>, <span class="at">max=</span><span class="dv">1</span>)</span>
<span id="cb24-8"><a href="pac-lme4.html#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb24-9"><a href="pac-lme4.html#cb24-9" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n=</span>G, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span><span class="fu">sqrt</span>(<span class="dv">9</span>)) <span class="co"># Intercepto aleatorio</span></span>
<span id="cb24-10"><a href="pac-lme4.html#cb24-10" aria-hidden="true" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="at">x=</span>b0, <span class="at">each=</span>ni)             <span class="co"># El mismo intercepto aleatorio pero repetido</span></span>
<span id="cb24-11"><a href="pac-lme4.html#cb24-11" aria-hidden="true" tabindex="-1"></a>media <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="dv">2</span> <span class="sc">-</span> <span class="dv">8</span> <span class="sc">*</span> x <span class="sc">+</span> b0)</span>
<span id="cb24-12"><a href="pac-lme4.html#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123456</span>)</span>
<span id="cb24-13"><a href="pac-lme4.html#cb24-13" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rgamma_glm</span>(<span class="at">n=</span>nobs, <span class="at">mu=</span>media, <span class="at">phi=</span><span class="fl">0.5</span>)</span>
<span id="cb24-14"><a href="pac-lme4.html#cb24-14" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(obs, grupo, b0, x, media, y)</span></code></pre></div>
<p>Vamos a explorar los datos simulados.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="pac-lme4.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rmarkdown)</span>
<span id="cb25-2"><a href="pac-lme4.html#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">paged_table</span>(datos, <span class="at">options =</span> <span class="fu">list</span>(<span class="at">rows.print =</span> <span class="dv">6</span>, <span class="at">cols.print=</span><span class="dv">6</span>))</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["obs"],"name":[1],"type":["int"],"align":["right"]},{"label":["grupo"],"name":[2],"type":["fct"],"align":["left"]},{"label":["b0"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["x"],"name":[4],"type":["dbl"],"align":["right"]},{"label":["media"],"name":[5],"type":["dbl"],"align":["right"]},{"label":["y"],"name":[6],"type":["dbl"],"align":["right"]}],"data":[{"1":"1","2":"1","3":"2.5011995","4":"0.797784321","5":"1.524262e-01","6":"2.053857e-01"},{"1":"2","2":"1","3":"2.5011995","4":"0.753565095","5":"2.171165e-01","6":"1.282032e-01"},{"1":"3","2":"1","3":"2.5011995","4":"0.391255684","5":"3.939895e+00","6":"1.263828e+00"},{"1":"4","2":"1","3":"2.5011995","4":"0.341556698","5":"5.863495e+00","6":"1.620260e+01"},{"1":"5","2":"1","3":"2.5011995","4":"0.361294113","5":"5.007048e+00","6":"6.749706e+00"},{"1":"6","2":"1","3":"2.5011995","4":"0.198344734","5":"1.843851e+01","6":"3.261757e+01"},{"1":"7","2":"1","3":"2.5011995","4":"0.534857962","5":"1.248991e+00","6":"3.828725e+00"},{"1":"8","2":"1","3":"2.5011995","4":"0.096526241","5":"4.163702e+01","6":"6.811768e+01"},{"1":"9","2":"1","3":"2.5011995","4":"0.987846943","5":"3.332071e-02","6":"1.705121e-02"},{"1":"10","2":"1","3":"2.5011995","4":"0.167569476","5":"2.358577e+01","6":"7.411486e+01"},{"1":"11","2":"1","3":"2.5011995","4":"0.797989130","5":"1.521766e-01","6":"5.468411e-02"},{"1":"12","2":"1","3":"2.5011995","4":"0.593794023","5":"7.794610e-01","6":"3.551081e-01"},{"1":"13","2":"1","3":"2.5011995","4":"0.905310010","5":"6.448771e-02","6":"5.614040e-02"},{"1":"14","2":"1","3":"2.5011995","4":"0.880848648","5":"7.842679e-02","6":"8.313473e-02"},{"1":"15","2":"1","3":"2.5011995","4":"0.993836551","5":"3.176174e-02","6":"1.623420e-02"},{"1":"16","2":"1","3":"2.5011995","4":"0.895956335","5":"6.949843e-02","6":"1.088668e-01"},{"1":"17","2":"1","3":"2.5011995","4":"0.878643351","5":"7.982270e-02","6":"1.805196e-01"},{"1":"18","2":"1","3":"2.5011995","4":"0.197605749","5":"1.854784e+01","6":"2.730600e+01"},{"1":"19","2":"1","3":"2.5011995","4":"0.334993600","5":"6.179582e+00","6":"1.386397e+01"},{"1":"20","2":"1","3":"2.5011995","4":"0.777206317","5":"1.797028e-01","6":"5.419281e-02"},{"1":"1","2":"2","3":"-0.8281433","4":"0.159593555","5":"9.004220e-01","6":"2.395883e-01"},{"1":"2","2":"2","3":"-0.8281433","4":"0.080645251","5":"1.693326e+00","6":"4.658703e-01"},{"1":"3","2":"2","3":"-0.8281433","4":"0.132650338","5":"1.117008e+00","6":"6.695379e-02"},{"1":"4","2":"2","3":"-0.8281433","4":"0.171905398","5":"8.159628e-01","6":"1.040914e+00"},{"1":"5","2":"2","3":"-0.8281433","4":"0.477777836","5":"7.062536e-02","6":"2.236095e-02"},{"1":"6","2":"2","3":"-0.8281433","4":"0.700504773","5":"1.188853e-02","6":"4.817563e-03"},{"1":"7","2":"2","3":"-0.8281433","4":"0.879889062","5":"2.830630e-03","6":"6.641047e-03"},{"1":"8","2":"2","3":"-0.8281433","4":"0.877793681","5":"2.878480e-03","6":"2.015156e-03"},{"1":"9","2":"2","3":"-0.8281433","4":"0.853879594","5":"3.485373e-03","6":"4.052601e-03"},{"1":"10","2":"2","3":"-0.8281433","4":"0.165987516","5":"8.555220e-01","6":"5.192650e-01"},{"1":"11","2":"2","3":"-0.8281433","4":"0.522968753","5":"4.919844e-02","6":"4.597891e-02"},{"1":"12","2":"2","3":"-0.8281433","4":"0.869128201","5":"3.085107e-03","6":"1.982837e-03"},{"1":"13","2":"2","3":"-0.8281433","4":"0.231156688","5":"5.079375e-01","6":"1.860015e-01"},{"1":"14","2":"2","3":"-0.8281433","4":"0.119080907","5":"1.245092e+00","6":"1.278972e+00"},{"1":"15","2":"2","3":"-0.8281433","4":"0.823951226","5":"4.428240e-03","6":"6.056715e-03"},{"1":"16","2":"2","3":"-0.8281433","4":"0.080276980","5":"1.698322e+00","6":"1.200165e+00"},{"1":"17","2":"2","3":"-0.8281433","4":"0.952363068","5":"1.585195e-03","6":"2.014926e-04"},{"1":"18","2":"2","3":"-0.8281433","4":"0.871617361","5":"3.024280e-03","6":"2.961951e-03"},{"1":"19","2":"2","3":"-0.8281433","4":"0.712153823","5":"1.083066e-02","6":"1.341880e-02"},{"1":"20","2":"2","3":"-0.8281433","4":"0.605404511","5":"2.544135e-02","6":"9.735014e-03"},{"1":"1","2":"3","3":"-1.0650055","4":"0.225432184","5":"4.195960e-01","6":"9.932062e-01"},{"1":"2","2":"3","3":"-1.0650055","4":"0.739595136","5":"6.861930e-03","6":"3.062791e-03"},{"1":"3","2":"3","3":"-1.0650055","4":"0.895542447","5":"1.970742e-03","6":"3.389939e-03"},{"1":"4","2":"3","3":"-1.0650055","4":"0.294463241","5":"2.415421e-01","6":"2.743625e-01"},{"1":"5","2":"3","3":"-1.0650055","4":"0.515352517","5":"4.126149e-02","6":"2.285062e-02"},{"1":"6","2":"3","3":"-1.0650055","4":"0.434649550","5":"7.869293e-02","6":"4.264296e-02"},{"1":"7","2":"3","3":"-1.0650055","4":"0.575165124","5":"2.557023e-02","6":"2.539531e-02"},{"1":"8","2":"3","3":"-1.0650055","4":"0.740956019","5":"6.787628e-03","6":"1.380076e-02"},{"1":"9","2":"3","3":"-1.0650055","4":"0.678172634","5":"1.121631e-02","6":"8.831998e-03"},{"1":"10","2":"3","3":"-1.0650055","4":"0.362016186","5":"1.406986e-01","6":"1.169051e-01"},{"1":"11","2":"3","3":"-1.0650055","4":"0.334557457","5":"1.752634e-01","6":"5.599323e-02"},{"1":"12","2":"3","3":"-1.0650055","4":"0.748855999","5":"6.371926e-03","6":"2.342938e-03"},{"1":"13","2":"3","3":"-1.0650055","4":"0.506616552","5":"4.424832e-02","6":"5.082525e-02"},{"1":"14","2":"3","3":"-1.0650055","4":"0.862259152","5":"2.571981e-03","6":"3.529131e-03"},{"1":"15","2":"3","3":"-1.0650055","4":"0.759557256","5":"5.849123e-03","6":"8.614546e-03"},{"1":"16","2":"3","3":"-1.0650055","4":"0.964383255","5":"1.136194e-03","6":"1.971615e-04"},{"1":"17","2":"3","3":"-1.0650055","4":"0.834437237","5":"3.213150e-03","6":"2.981841e-03"},{"1":"18","2":"3","3":"-1.0650055","4":"0.837036932","5":"3.147015e-03","6":"1.459904e-03"},{"1":"19","2":"3","3":"-1.0650055","4":"0.267467090","5":"2.997693e-01","6":"9.388466e-02"},{"1":"20","2":"3","3":"-1.0650055","4":"0.175932494","5":"6.234632e-01","6":"4.584881e-01"},{"1":"1","2":"4","3":"0.2624623","4":"0.196035676","5":"2.002060e+00","6":"9.580622e-01"},{"1":"2","2":"4","3":"0.2624623","4":"0.019580189","5":"8.213842e+00","6":"9.846444e+00"},{"1":"3","2":"4","3":"0.2624623","4":"0.527727398","5":"1.409490e-01","6":"9.065933e-02"},{"1":"4","2":"4","3":"0.2624623","4":"0.181629571","5":"2.246617e+00","6":"9.247366e-01"},{"1":"5","2":"4","3":"0.2624623","4":"0.147734747","5":"2.946401e+00","6":"5.180932e+00"},{"1":"6","2":"4","3":"0.2624623","4":"0.590974018","5":"8.498081e-02","6":"3.262987e-02"},{"1":"7","2":"4","3":"0.2624623","4":"0.002990070","5":"9.379643e+00","6":"2.540086e+00"},{"1":"8","2":"4","3":"0.2624623","4":"0.361016099","5":"5.349048e-01","6":"4.580180e-01"},{"1":"9","2":"4","3":"0.2624623","4":"0.129267699","5":"3.415489e+00","6":"3.862539e+00"},{"1":"10","2":"4","3":"0.2624623","4":"0.014579048","5":"8.549133e+00","6":"1.155800e+01"},{"1":"11","2":"4","3":"0.2624623","4":"0.194430504","5":"2.027935e+00","6":"3.337767e+00"},{"1":"12","2":"4","3":"0.2624623","4":"0.648670685","5":"5.356265e-02","6":"4.184079e-02"},{"1":"13","2":"4","3":"0.2624623","4":"0.940628788","5":"5.181980e-03","6":"1.409878e-03"},{"1":"14","2":"4","3":"0.2624623","4":"0.346356111","5":"6.014652e-01","6":"3.778192e-01"},{"1":"15","2":"4","3":"0.2624623","4":"0.844968148","5":"1.113922e-02","6":"1.702633e-02"},{"1":"16","2":"4","3":"0.2624623","4":"0.129383537","5":"3.412325e+00","6":"2.036657e+00"},{"1":"17","2":"4","3":"0.2624623","4":"0.851756020","5":"1.055046e-02","6":"2.550220e-02"},{"1":"18","2":"4","3":"0.2624623","4":"0.218427168","5":"1.673714e+00","6":"1.382578e+00"},{"1":"19","2":"4","3":"0.2624623","4":"0.132231356","5":"3.335463e+00","6":"1.829126e+00"},{"1":"20","2":"4","3":"0.2624623","4":"0.621454719","5":"6.659169e-02","6":"8.107802e-03"},{"1":"1","2":"5","3":"6.7567672","4":"0.142016269","5":"2.039861e+03","6":"6.947431e+02"},{"1":"2","2":"5","3":"6.7567672","4":"0.001311457","5":"6.287228e+03","6":"8.913434e+03"},{"1":"3","2":"5","3":"6.7567672","4":"0.833433097","5":"8.079277e+00","6":"6.702226e+00"},{"1":"4","2":"5","3":"6.7567672","4":"0.945494323","5":"3.296339e+00","6":"2.194756e+00"},{"1":"5","2":"5","3":"6.7567672","4":"0.567900916","5":"6.759675e+01","6":"6.194953e+01"},{"1":"6","2":"5","3":"6.7567672","4":"0.401693776","5":"2.554986e+02","6":"3.722422e+02"},{"1":"7","2":"5","3":"6.7567672","4":"0.185059548","5":"1.445616e+03","6":"6.929186e+02"},{"1":"8","2":"5","3":"6.7567672","4":"0.547540751","5":"7.955441e+01","6":"7.142502e+01"},{"1":"9","2":"5","3":"6.7567672","4":"0.562885564","5":"7.036406e+01","6":"1.279147e+02"},{"1":"10","2":"5","3":"6.7567672","4":"0.160966964","5":"1.752908e+03","6":"2.413444e+02"},{"1":"11","2":"5","3":"6.7567672","4":"0.307851881","5":"5.412884e+02","6":"1.077463e+03"},{"1":"12","2":"5","3":"6.7567672","4":"0.359530449","5":"3.579966e+02","6":"4.882541e+02"},{"1":"13","2":"5","3":"6.7567672","4":"0.167041455","5":"1.669761e+03","6":"2.207170e+03"},{"1":"14","2":"5","3":"6.7567672","4":"0.193425931","5":"1.352026e+03","6":"7.501872e+02"},{"1":"15","2":"5","3":"6.7567672","4":"0.454724279","5":"1.671636e+02","6":"2.850987e+02"},{"1":"16","2":"5","3":"6.7567672","4":"0.039457683","5":"4.633676e+03","6":"9.592586e+03"},{"1":"17","2":"5","3":"6.7567672","4":"0.861249396","5":"6.467386e+00","6":"5.054696e+00"},{"1":"18","2":"5","3":"6.7567672","4":"0.768159446","5":"1.361935e+01","6":"1.172300e+01"},{"1":"19","2":"5","3":"6.7567672","4":"0.112823530","5":"2.576479e+03","6":"6.785208e+03"},{"1":"20","2":"5","3":"6.7567672","4":"0.395910402","5":"2.675975e+02","6":"3.768951e+02"},{"1":"1","2":"6","3":"2.5033804","4":"0.038553689","5":"6.635047e+01","6":"5.191330e+00"},{"1":"2","2":"6","3":"2.5033804","4":"0.659447520","5":"4.619957e-01","6":"2.429551e-01"},{"1":"3","2":"6","3":"2.5033804","4":"0.311468526","5":"7.475509e+00","6":"1.454371e+01"},{"1":"4","2":"6","3":"2.5033804","4":"0.189569148","5":"1.982269e+01","6":"1.771431e+01"},{"1":"5","2":"6","3":"2.5033804","4":"0.626071314","5":"6.033908e-01","6":"3.837080e-01"},{"1":"6","2":"6","3":"2.5033804","4":"0.516718460","5":"1.447203e+00","6":"2.400666e+00"},{"1":"7","2":"6","3":"2.5033804","4":"0.927945729","5":"5.392369e-02","6":"3.017928e-02"},{"1":"8","2":"6","3":"2.5033804","4":"0.058377382","5":"5.661995e+01","6":"3.364584e+01"},{"1":"9","2":"6","3":"2.5033804","4":"0.937883046","5":"4.980280e-02","6":"1.213706e-01"},{"1":"10","2":"6","3":"2.5033804","4":"0.619334799","5":"6.368010e-01","6":"7.206382e-01"},{"1":"11","2":"6","3":"2.5033804","4":"0.367090744","5":"4.790594e+00","6":"1.957441e+00"},{"1":"12","2":"6","3":"2.5033804","4":"0.058114369","5":"5.673921e+01","6":"1.114632e+02"},{"1":"13","2":"6","3":"2.5033804","4":"0.140639918","5":"2.931974e+01","6":"4.832906e+01"},{"1":"14","2":"6","3":"2.5033804","4":"0.401357744","5":"3.641947e+00","6":"3.705224e+00"},{"1":"15","2":"6","3":"2.5033804","4":"0.068011582","5":"5.241998e+01","6":"4.322961e+01"},{"1":"16","2":"6","3":"2.5033804","4":"0.321577321","5":"6.894761e+00","6":"7.815920e+00"},{"1":"17","2":"6","3":"2.5033804","4":"0.400231984","5":"3.674895e+00","6":"3.340051e+00"},{"1":"18","2":"6","3":"2.5033804","4":"0.195452195","5":"1.891136e+01","6":"1.863996e+01"},{"1":"19","2":"6","3":"2.5033804","4":"0.451480188","5":"2.438880e+00","6":"1.854537e+00"},{"1":"20","2":"6","3":"2.5033804","4":"0.964729452","5":"4.017722e-02","6":"2.462229e-02"},{"1":"1","2":"7","3":"3.9372465","4":"0.258174567","5":"4.803116e+01","6":"5.826340e+01"},{"1":"2","2":"7","3":"3.9372465","4":"0.209855853","5":"7.069676e+01","6":"9.177084e+01"},{"1":"3","2":"7","3":"3.9372465","4":"0.622888441","5":"2.596434e+00","6":"6.378537e+00"},{"1":"4","2":"7","3":"3.9372465","4":"0.970139089","5":"1.614005e-01","6":"2.238217e-01"},{"1":"5","2":"7","3":"3.9372465","4":"0.548871447","5":"4.693952e+00","6":"9.869144e-01"},{"1":"6","2":"7","3":"3.9372465","4":"0.466953993","5":"9.039597e+00","6":"6.389105e+00"},{"1":"7","2":"7","3":"3.9372465","4":"0.201341139","5":"7.568026e+01","6":"1.307303e+02"},{"1":"8","2":"7","3":"3.9372465","4":"0.025514266","5":"3.089355e+02","6":"8.981062e+02"},{"1":"9","2":"7","3":"3.9372465","4":"0.725887402","5":"1.138996e+00","6":"7.828167e-01"},{"1":"10","2":"7","3":"3.9372465","4":"0.282450906","5":"3.955291e+01","6":"2.476667e+01"},{"1":"11","2":"7","3":"3.9372465","4":"0.402866402","5":"1.509427e+01","6":"5.674040e+01"},{"1":"12","2":"7","3":"3.9372465","4":"0.596137450","5":"3.216028e+00","6":"3.205588e+00"},{"1":"13","2":"7","3":"3.9372465","4":"0.426746040","5":"1.246941e+01","6":"8.444413e+00"},{"1":"14","2":"7","3":"3.9372465","4":"0.612111216","5":"2.830227e+00","6":"5.453746e+00"},{"1":"15","2":"7","3":"3.9372465","4":"0.509237387","5":"6.445276e+00","6":"4.355487e+00"},{"1":"16","2":"7","3":"3.9372465","4":"0.427807820","5":"1.236394e+01","6":"6.035722e+00"},{"1":"17","2":"7","3":"3.9372465","4":"0.313961759","5":"3.073962e+01","6":"2.466814e+01"},{"1":"18","2":"7","3":"3.9372465","4":"0.889894750","5":"3.066919e-01","6":"2.346954e-01"},{"1":"19","2":"7","3":"3.9372465","4":"0.230285685","5":"6.003700e+01","6":"2.433930e+01"},{"1":"20","2":"7","3":"3.9372465","4":"0.060422489","5":"2.336599e+02","6":"1.630710e+02"},{"1":"1","2":"8","3":"7.5079362","4":"0.903628521","5":"9.766011e+00","6":"1.506369e+01"},{"1":"2","2":"8","3":"7.5079362","4":"0.661719573","5":"6.763866e+01","6":"1.246416e+02"},{"1":"3","2":"8","3":"7.5079362","4":"0.713792858","5":"4.459373e+01","6":"1.520326e+01"},{"1":"4","2":"8","3":"7.5079362","4":"0.804657821","5":"2.155642e+01","6":"4.137767e+01"},{"1":"5","2":"8","3":"7.5079362","4":"0.035533873","5":"1.013414e+04","6":"7.790224e+03"},{"1":"6","2":"8","3":"7.5079362","4":"0.471381018","5":"3.100979e+02","6":"2.245479e+02"},{"1":"7","2":"8","3":"7.5079362","4":"0.669429686","5":"6.359270e+01","6":"2.190856e+01"},{"1":"8","2":"8","3":"7.5079362","4":"0.766057726","5":"2.935534e+01","6":"3.795826e+01"},{"1":"9","2":"8","3":"7.5079362","4":"0.074779771","5":"7.403425e+03","6":"1.791654e+02"},{"1":"10","2":"8","3":"7.5079362","4":"0.518188222","5":"2.132426e+02","6":"1.989655e+02"},{"1":"11","2":"8","3":"7.5079362","4":"0.829661675","5":"1.764836e+01","6":"1.142516e+01"},{"1":"12","2":"8","3":"7.5079362","4":"0.636695309","5":"8.263008e+01","6":"2.557097e+01"},{"1":"13","2":"8","3":"7.5079362","4":"0.234845352","5":"2.057349e+03","6":"1.504656e+03"},{"1":"14","2":"8","3":"7.5079362","4":"0.757660399","5":"3.139514e+01","6":"1.251088e+01"},{"1":"15","2":"8","3":"7.5079362","4":"0.519444841","5":"2.111096e+02","6":"1.075557e+02"},{"1":"16","2":"8","3":"7.5079362","4":"0.242003662","5":"1.942842e+03","6":"7.950220e+02"},{"1":"17","2":"8","3":"7.5079362","4":"0.058963733","5":"8.402011e+03","6":"7.854203e+03"},{"1":"18","2":"8","3":"7.5079362","4":"0.739833746","5":"3.620750e+01","6":"1.604064e+01"},{"1":"19","2":"8","3":"7.5079362","4":"0.010657263","5":"1.236565e+04","6":"2.414866e+02"},{"1":"20","2":"8","3":"7.5079362","4":"0.209103289","5":"2.527813e+03","6":"1.462415e+03"},{"1":"1","2":"9","3":"3.5046952","4":"0.876560551","5":"2.213989e-01","6":"5.974171e-02"},{"1":"2","2":"9","3":"3.5046952","4":"0.270820822","5":"2.816637e+01","6":"4.306805e+01"},{"1":"3","2":"9","3":"3.5046952","4":"0.240487445","5":"3.590210e+01","6":"5.386466e+01"},{"1":"4","2":"9","3":"3.5046952","4":"0.758846366","5":"5.677491e-01","6":"4.651666e-02"},{"1":"5","2":"9","3":"3.5046952","4":"0.057764289","5":"1.548692e+02","6":"1.357630e+01"},{"1":"6","2":"9","3":"3.5046952","4":"0.450906384","5":"6.668828e+00","6":"4.602653e+00"},{"1":"7","2":"9","3":"3.5046952","4":"0.697893490","5":"9.245458e-01","6":"5.233054e-01"},{"1":"8","2":"9","3":"3.5046952","4":"0.893318857","5":"1.936204e-01","6":"1.481719e-01"},{"1":"9","2":"9","3":"3.5046952","4":"0.143453675","5":"7.802785e+01","6":"7.302604e+01"},{"1":"10","2":"9","3":"3.5046952","4":"0.105280198","5":"1.058956e+02","6":"2.231036e+01"},{"1":"11","2":"9","3":"3.5046952","4":"0.518765057","5":"3.875113e+00","6":"6.576133e+00"},{"1":"12","2":"9","3":"3.5046952","4":"0.135579805","5":"8.310100e+01","6":"1.232832e+02"},{"1":"13","2":"9","3":"3.5046952","4":"0.801794218","5":"4.026617e-01","6":"2.619976e-01"},{"1":"14","2":"9","3":"3.5046952","4":"0.801857366","5":"4.024583e-01","6":"2.865926e-01"},{"1":"15","2":"9","3":"3.5046952","4":"0.667375555","5":"1.180208e+00","6":"1.618134e+00"},{"1":"16","2":"9","3":"3.5046952","4":"0.959161536","5":"1.143379e-01","6":"1.107210e-01"},{"1":"17","2":"9","3":"3.5046952","4":"0.699445138","5":"9.131402e-01","6":"6.942581e-02"},{"1":"18","2":"9","3":"3.5046952","4":"0.061485361","5":"1.503269e+02","6":"1.263904e+02"},{"1":"19","2":"9","3":"3.5046952","4":"0.399791784","5":"1.003783e+01","6":"1.519241e+01"},{"1":"20","2":"9","3":"3.5046952","4":"0.287793164","5":"2.459025e+01","6":"3.090844e+01"},{"1":"1","2":"10","3":"-1.2784967","4":"0.309646739","5":"1.727913e-01","6":"9.441791e-02"},{"1":"2","2":"10","3":"-1.2784967","4":"0.606127150","5":"1.612291e-02","6":"1.956449e-02"},{"1":"3","2":"10","3":"-1.2784967","4":"0.896183561","5":"1.583741e-03","6":"1.495776e-03"},{"1":"4","2":"10","3":"-1.2784967","4":"0.675651089","5":"9.244695e-03","6":"5.638533e-03"},{"1":"5","2":"10","3":"-1.2784967","4":"0.713956382","5":"6.804659e-03","6":"3.028423e-03"},{"1":"6","2":"10","3":"-1.2784967","4":"0.757299039","5":"4.810814e-03","6":"5.461346e-03"},{"1":"7","2":"10","3":"-1.2784967","4":"0.365183382","5":"1.108072e-01","6":"6.375806e-02"},{"1":"8","2":"10","3":"-1.2784967","4":"0.316438691","5":"1.636531e-01","6":"3.796169e-01"},{"1":"9","2":"10","3":"-1.2784967","4":"0.765715639","5":"4.497553e-03","6":"1.303504e-03"},{"1":"10","2":"10","3":"-1.2784967","4":"0.356662716","5":"1.186238e-01","6":"5.485145e-02"},{"1":"11","2":"10","3":"-1.2784967","4":"0.806231361","5":"3.252447e-03","6":"4.396185e-03"},{"1":"12","2":"10","3":"-1.2784967","4":"0.580240505","5":"1.983275e-02","6":"1.297773e-02"},{"1":"13","2":"10","3":"-1.2784967","4":"0.644028046","5":"1.190590e-02","6":"5.262784e-03"},{"1":"14","2":"10","3":"-1.2784967","4":"0.638116490","5":"1.248249e-02","6":"2.895101e-02"},{"1":"15","2":"10","3":"-1.2784967","4":"0.943357178","5":"1.085891e-03","6":"1.346795e-04"},{"1":"16","2":"10","3":"-1.2784967","4":"0.896202200","5":"1.583505e-03","6":"1.060888e-03"},{"1":"17","2":"10","3":"-1.2784967","4":"0.524069688","5":"3.108424e-02","6":"6.251660e-02"},{"1":"18","2":"10","3":"-1.2784967","4":"0.964403580","5":"9.176217e-04","6":"4.058467e-04"},{"1":"19","2":"10","3":"-1.2784967","4":"0.551206809","5":"2.501821e-02","6":"4.047913e-02"},{"1":"20","2":"10","3":"-1.2784967","4":"0.343483454","5":"1.318139e-01","6":"1.759281e-01"}],"options":{"columns":{"min":{},"max":[6]},"rows":{"min":[6],"max":[6]},"pages":{}}}
  </script>
</div>
<p>El siguiente paso es explorar los datos simulados. El código para dibujar los datos se muestra abajo.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="pac-lme4.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb26-2"><a href="pac-lme4.html#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos, <span class="fu">aes</span>(x, y, <span class="at">color=</span>grupo) ) <span class="sc">+</span> </span>
<span id="cb26-3"><a href="pac-lme4.html#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb26-4"><a href="pac-lme4.html#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">colour=</span><span class="st">&quot;Grupo/Cluster&quot;</span>)</span></code></pre></div>
<p><img src="libro_mod_mixtos_files/figure-html/plot_simul_b0_gamma-1.png" width="672" /></p>
<p>Para estimar los parámetros del modelos se usa la función <code>glmer</code> de la siguiente forma.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="pac-lme4.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb27-2"><a href="pac-lme4.html#cb27-2" aria-hidden="true" tabindex="-1"></a>fit2 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(y <span class="sc">~</span> x <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> grupo), <span class="at">family=</span><span class="fu">Gamma</span>(<span class="at">link=</span><span class="st">&quot;log&quot;</span>), <span class="at">data =</span> datos)</span></code></pre></div>
<p>La función <code>summary</code> se puede usar sobre el objeto <code>fit2</code> para obtener una tabla de resumen, a continuación se la salida de <code>summary</code>.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="pac-lme4.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2)</span></code></pre></div>
<pre><code>## Generalized linear mixed model fit by maximum likelihood (Laplace
##   Approximation) [glmerMod]
##  Family: Gamma  ( log )
## Formula: y ~ x + (1 | grupo)
##    Data: datos
## 
##      AIC      BIC   logLik deviance df.resid 
##    591.6    604.8   -291.8    583.6      196 
## 
## Scaled residuals: 
##     Min      1Q  Median      3Q     Max 
## -1.4164 -0.7151 -0.2155  0.5631  3.0609 
## 
## Random effects:
##  Groups   Name        Variance Std.Dev.
##  grupo    (Intercept) 4.3265   2.0800  
##  Residual             0.4728   0.6876  
## Number of obs: 200, groups:  grupo, 10
## 
## Fixed effects:
##             Estimate Std. Error  t value Pr(&gt;|z|)    
## (Intercept)   4.3965     0.9566    4.596 4.31e-06 ***
## x            -8.0784     0.0411 -196.549  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Correlation of Fixed Effects:
##   (Intr)
## x -0.021</code></pre>
<p>Según el resultado anterior <span class="math inline">\(\hat{\boldsymbol{\Theta}}=(\hat{\beta}_0=4.3965, \hat{\beta}_1=-8.0784, \hat{\phi}=0.4728, \hat{\sigma}_{bo}=4.3265)^\top\)</span> mientras que el vector real de parámetros es <span class="math inline">\(\boldsymbol{\Theta}=(\beta_0=2, \beta_1=-8, \phi=0.50, \sigma_{b0}=3)^\top\)</span>.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-R-lme4" class="csl-entry">
Bates, Douglas, Martin Maechler, Ben Bolker, and Steven Walker. 2021. <em>Lme4: Linear Mixed-Effects Models Using Eigen and S4</em>. <a href="https://github.com/lme4/lme4/">https://github.com/lme4/lme4/</a>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="shiny.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="apli-lme4.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/fhernanb/libro_modelos_mixtos/edit/master/302-paquete-lme4.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
